This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.gitignore
backend/api-gateway/.env.example
backend/api-gateway/package.json
backend/api-gateway/src/index.js
backend/api-gateway/src/middleware/proxy.js
backend/api-gateway/src/middleware/swagger.js
backend/api-gateway/src/routes/gateway.js
backend/auth-service/.env.example
backend/auth-service/package.json
backend/auth-service/src/database.js
backend/auth-service/src/index.js
backend/auth-service/src/routes/auth.js
backend/auth-service/src/routes/auth.ts
backend/movies-service/.env.example
backend/movies-service/package.json
backend/movies-service/src/database.js
backend/movies-service/src/index.js
backend/movies-service/src/routes/movies.js
backend/payment-service/.env.example
backend/payment-service/package.json
backend/payment-service/src/database.js
backend/payment-service/src/index.js
backend/payment-service/src/routes/payments.js
backend/payment-service/src/utils/cardValidator.js
docker-compose.yml
frontend/.env.example
frontend/.gitignore
frontend/eslint.config.js
frontend/index.html
frontend/package.json
frontend/postcss.config.js
frontend/public/vite.svg
frontend/README.md
frontend/src/App.css
frontend/src/App.tsx
frontend/src/assets/react.svg
frontend/src/components/Footer.tsx
frontend/src/components/Header.tsx
frontend/src/index.css
frontend/src/main.tsx
frontend/src/pages/HomePage.tsx
frontend/src/pages/MovieDetailPage.tsx
frontend/src/pages/MoviesPage.tsx
frontend/src/services/api.ts
frontend/src/services/authService.ts
frontend/src/services/movieService.ts
frontend/src/services/paymentService.ts
frontend/tailwind.config.js
frontend/tsconfig.app.json
frontend/tsconfig.json
frontend/tsconfig.node.json
frontend/vite.config.ts
nginx/nginx.conf
package.json
README.md
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path=".gitignore">
# Dependencies
node_modules/
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# Production builds
build/
dist/
.next/

# Environment variables
.env
.env.local
.env.development.local
.env.test.local
.env.production.local

# IDE
.vscode/
.idea/
*.swp
*.swo

# OS
.DS_Store
Thumbs.db

# Logs
logs/
*.log

# Database
*.db
*.sqlite

# Docker
.dockerignore

# Kubernetes
secrets/

# Temporary files
tmp/
temp/
</file>

<file path="backend/api-gateway/package.json">
{
  "name": "api-gateway",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "start": "node src/index.js",
    "dev": "nodemon src/index.js",
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "type": "module",
  "dependencies": {
    "cors": "^2.8.6",
    "dotenv": "^17.3.1",
    "express": "^5.2.1",
    "helmet": "^8.1.0",
    "http-proxy-middleware": "^3.0.5",
    "morgan": "^1.10.1",
    "swagger-jsdoc": "^6.2.8",
    "swagger-ui-express": "^5.0.1"
  },
  "devDependencies": {
    "nodemon": "^3.1.11"
  }
}
</file>

<file path="backend/api-gateway/src/middleware/proxy.js">
import { createProxyMiddleware } from 'http-proxy-middleware';

// –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–∫—Å–∏ –¥–ª—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤
export const authProxy = createProxyMiddleware({
  target: process.env.AUTH_SERVICE_URL || 'http://localhost:3001',
  changeOrigin: true,
  pathRewrite: {
    '^/api/auth': '', // –£–±–∏—Ä–∞–µ–º /api/auth –ø—Ä–∏ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–∏
  },
  onError: (err, req, res) => {
    console.error('Auth Service Proxy Error:', err.message);
    res.status(503).json({
      error: 'Auth Service unavailable',
      message: 'Authentication service is temporarily unavailable'
    });
  },
  onProxyReq: (proxyReq, req, res) => {
    console.log(`üîÑ Proxying to Auth Service: ${req.method} ${req.url}`);
  }
});

export const moviesProxy = createProxyMiddleware({
  target: process.env.MOVIES_SERVICE_URL || 'http://localhost:3002',
  changeOrigin: true,
  pathRewrite: {
    '^/api/movies$': '/',     // /api/movies -> /
    '^/api/movies/': '/'      // /api/movies/... -> /...
  },
  onError: (err, req, res) => {
    console.error('Movies Service Proxy Error:', err.message);
    res.status(503).json({
      error: 'Movies Service unavailable',
      message: 'Movies service is temporarily unavailable'
    });
  },
  onProxyReq: (proxyReq, req, res) => {
    console.log(`üîÑ Proxying to Movies Service: ${req.method} ${req.url}`);
  }
});

export const paymentProxy = createProxyMiddleware({
  target: process.env.PAYMENT_SERVICE_URL || 'http://localhost:3003',
  changeOrigin: true,
  pathRewrite: {
    '^/api/payment': '', // –£–±–∏—Ä–∞–µ–º /api/payment –ø—Ä–∏ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–∏
  },
  onError: (err, req, res) => {
    console.error('Payment Service Proxy Error:', err.message);
    res.status(503).json({
      error: 'Payment Service unavailable',
      message: 'Payment service is temporarily unavailable'
    });
  },
  onProxyReq: (proxyReq, req, res) => {
    console.log(`üîÑ Proxying to Payment Service: ${req.method} ${req.url}`);
  }
});

// Middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤
export const healthCheckMiddleware = (req, res, next) => {
  const services = [
    { name: 'Auth Service', url: process.env.AUTH_SERVICE_URL || 'http://localhost:3001' },
    { name: 'Movies Service', url: process.env.MOVIES_SERVICE_URL || 'http://localhost:3002' },
    { name: 'Payment Service', url: process.env.PAYMENT_SERVICE_URL || 'http://localhost:3003' }
  ];

  Promise.all(
    services.map(async (service) => {
      try {
        const response = await fetch(`${service.url}/health`, { timeout: 5000 });
        return {
          name: service.name,
          url: service.url,
          status: response.ok ? 'healthy' : 'unhealthy',
          responseTime: response.headers.get('x-response-time') || 'unknown'
        };
      } catch (error) {
        return {
          name: service.name,
          url: service.url,
          status: 'unhealthy',
          error: error.message
        };
      }
    })
  ).then(healthResults => {
    req.servicesHealth = healthResults;
    next();
  }).catch(error => {
    console.error('Health check error:', error);
    req.servicesHealth = services.map(service => ({
      name: service.name,
      url: service.url,
      status: 'unknown',
      error: 'Health check failed'
    }));
    next();
  });
};
</file>

<file path="backend/api-gateway/src/middleware/swagger.js">
import swaggerJsdoc from 'swagger-jsdoc';
import swaggerUi from 'swagger-ui-express';

// Swagger –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
const swaggerOptions = {
  definition: {
    openapi: '3.0.0',
    info: {
      title: 'CineScope API Gateway',
      version: '1.0.0',
      description: 'API Gateway for CineScope microservices architecture',
      contact: {
        name: 'CineScope Team',
        email: 'support@cinescope.com'
      }
    },
    servers: [
      {
        url: `http://localhost:${process.env.PORT || 8080}`,
        description: 'Development server'
      }
    ],
    components: {
      securitySchemes: {
        bearerAuth: {
          type: 'http',
          scheme: 'bearer',
          bearerFormat: 'JWT'
        }
      },
      schemas: {
        User: {
          type: 'object',
          required: ['email', 'password'],
          properties: {
            id: {
              type: 'integer',
              description: 'User ID'
            },
            email: {
              type: 'string',
              format: 'email',
              description: 'User email'
            },
            password: {
              type: 'string',
              description: 'User password'
            },
            created_at: {
              type: 'string',
              format: 'date-time',
              description: 'Creation date'
            }
          }
        },
        Movie: {
          type: 'object',
          properties: {
            id: {
              type: 'integer',
              description: 'Movie ID'
            },
            title: {
              type: 'string',
              description: 'Movie title'
            },
            description: {
              type: 'string',
              description: 'Movie description'
            },
            duration: {
              type: 'integer',
              description: 'Duration in minutes'
            },
            rating: {
              type: 'number',
              description: 'Movie rating'
            },
            genre: {
              type: 'string',
              description: 'Movie genre'
            },
            release_year: {
              type: 'integer',
              description: 'Release year'
            }
          }
        },
        Payment: {
          type: 'object',
          required: ['userId', 'amount'],
          properties: {
            id: {
              type: 'integer',
              description: 'Payment ID'
            },
            userId: {
              type: 'integer',
              description: 'User ID'
            },
            amount: {
              type: 'number',
              description: 'Payment amount'
            },
            currency: {
              type: 'string',
              description: 'Currency code'
            },
            status: {
              type: 'string',
              enum: ['pending', 'completed', 'failed', 'refunded'],
              description: 'Payment status'
            },
            transactionId: {
              type: 'string',
              description: 'Transaction ID'
            }
          }
        },
        Error: {
          type: 'object',
          properties: {
            error: {
              type: 'string',
              description: 'Error type'
            },
            message: {
              type: 'string',
              description: 'Error message'
            }
          }
        }
      }
    },
    tags: [
      {
        name: 'Authentication',
        description: 'User authentication operations'
      },
      {
        name: 'Movies',
        description: 'Movie management operations'
      },
      {
        name: 'Payments',
        description: 'Payment processing operations'
      },
      {
        name: 'Gateway',
        description: 'API Gateway operations'
      }
    ]
  },
  apis: ['./src/routes/*.js'], // –ü—É—Ç—å –∫ —Ñ–∞–π–ª–∞–º —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π
};

// –°–æ–∑–¥–∞–µ–º Swagger —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é
export const specs = swaggerJsdoc(swaggerOptions);

// Swagger UI –æ–ø—Ü–∏–∏
export const swaggerUiOptions = {
  customCss: `
    .swagger-ui .topbar { display: none }
    .swagger-ui .info .title { color: #2563eb }
    .swagger-ui .scheme-container { background: #f8fafc }
  `,
  customSiteTitle: 'CineScope API Documentation'
};

// Middleware –¥–ª—è Swagger
export const swaggerMiddleware = swaggerUi.serve;

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Swagger UI
export const swaggerSetup = swaggerUi.setup(specs, swaggerUiOptions);
</file>

<file path="backend/auth-service/.env.example">
# Server Configuration
PORT=3001
NODE_ENV=development

# Database Configuration
DB_HOST=localhost
DB_PORT=5432
DB_NAME=cinescope_auth
DB_USER=postgres
DB_PASSWORD=password

# JWT Configuration
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_EXPIRES_IN=24h

# CORS Configuration
FRONTEND_URL=http://localhost:5173
</file>

<file path="backend/auth-service/src/routes/auth.ts">
import express from 'express';
import bcrypt from 'bcryptjs';
import jwt from 'jsonwebtoken';
import db from '../database';

const router = express.Router();

// –ü–æ–ª—É—á–∞–µ–º —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
const JWT_SECRET = process.env.JWT_SECRET;
if (!JWT_SECRET) {
  throw new Error('JWT_SECRET is not defined in .env file');
}

const JWT_EXPIRES_IN = process.env.JWT_EXPIRES_IN || '24h';

// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
router.post('/register', async (req, res) => {
  const { email, password } = req.body;

  if (!email || !password) {
    return res.status(400).json({ error: 'Email and password are required' });
  }

  try {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    db.get('SELECT id FROM users WHERE email = ?', [email], async (err, row) => {
      if (err) {
        return res.status(500).json({ error: 'Database error' });
      }

      if (row) {
        return res.status(400).json({ error: 'User already exists' });
      }

      // –•–µ—à–∏—Ä—É–µ–º –ø–∞—Ä–æ–ª—å
      const hashedPassword = await bcrypt.hash(password, 10);

      // –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      db.run(
        'INSERT INTO users (email, password_hash) VALUES (?, ?)',
        [email, hashedPassword],
        function(err) {
          if (err) {
            return res.status(500).json({ error: 'Database error' });
          }

          res.status(201).json({ 
            message: 'User created successfully',
            userId: this.lastID 
          });
        }
      );
    });
  } catch (error) {
    res.status(500).json({ error: 'Server error' });
  }
});

// –í—Ö–æ–¥
router.post('/login', async (req, res) => {
  const { email, password } = req.body;

  if (!email || !password) {
    return res.status(400).json({ error: 'Email and password are required' });
  }

  try {
    db.get('SELECT * FROM users WHERE email = ?', [email], async (err, row: any) => {
      if (err) {
        return res.status(500).json({ error: 'Database error' });
      }

      if (!row) {
        return res.status(401).json({ error: 'Invalid credentials' });
      }

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ä–æ–ª—å
      const isValidPassword = await bcrypt.compare(password, row.password_hash);
      if (!isValidPassword) {
        return res.status(401).json({ error: 'Invalid credentials' });
      }

      // –°–æ–∑–¥–∞–µ–º JWT —Ç–æ–∫–µ–Ω - –ü–†–û–°–¢–û–ô –í–ê–†–ò–ê–ù–¢
      const payload = { userId: row.id, email: row.email };
      const token = jwt.sign(payload, JWT_SECRET, { expiresIn: JWT_EXPIRES_IN });

      res.json({
        message: 'Login successful',
        token,
        user: {
          id: row.id,
          email: row.email
        }
      });
    });
  } catch (error) {
    res.status(500).json({ error: 'Server error' });
  }
});

// –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
router.get('/profile', (req, res) => {
  const token = req.headers.authorization?.split(' ')[1];

  if (!token) {
    return res.status(401).json({ error: 'Token is required' });
  }

  try {
    const decoded = jwt.verify(token, JWT_SECRET) as any;
    
    db.get('SELECT id, email, created_at FROM users WHERE id = ?', [decoded.userId], (err, row: any) => {
      if (err) {
        return res.status(500).json({ error: 'Database error' });
      }

      if (!row) {
        return res.status(404).json({ error: 'User not found' });
      }

      res.json({ user: row });
    });
  } catch (error) {
    res.status(401).json({ error: 'Invalid token' });
  }
});

export default router;
</file>

<file path="backend/movies-service/.env.example">
# Server Configuration
PORT=3002
NODE_ENV=development

# Database Configuration
DB_HOST=localhost
DB_PORT=5432
DB_NAME=cinescope_movies
DB_USER=postgres
DB_PASSWORD=password

# Auth Service Configuration
AUTH_SERVICE_URL=http://localhost:3001

# CORS Configuration
FRONTEND_URL=http://localhost:5173
</file>

<file path="backend/movies-service/package.json">
{
  "name": "movies-service",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "start": "node src/index.js",
    "dev": "nodemon src/index.js",
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "type": "module",
  "dependencies": {
    "cors": "^2.8.6",
    "dotenv": "^17.3.1",
    "express": "^5.2.1",
    "helmet": "^8.1.0",
    "morgan": "^1.10.1",
    "sqlite3": "^5.1.7"
  },
  "devDependencies": {
    "nodemon": "^3.1.11"
  }
}
</file>

<file path="backend/movies-service/src/database.js">
import sqlite3 from 'sqlite3';
import path from 'path';

const dbPath = path.join(process.cwd(), 'movies.sqlite');

const db = new sqlite3.Database(dbPath, (err) => {
  if (err) {
    console.error('Error opening database:', err.message);
  } else {
    console.log('‚úÖ Connected to SQLite database');
    createTables();
  }
});

function createTables() {
  // –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É —Ñ–∏–ª—å–º–æ–≤
  db.run(`
    CREATE TABLE IF NOT EXISTS movies (
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      title TEXT NOT NULL,
      description TEXT,
      duration INTEGER,
      rating REAL,
      poster_url TEXT,
      genre TEXT,
      release_year INTEGER,
      created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
      updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
    )
  `, (err) => {
    if (err) {
      console.error('Error creating movies table:', err.message);
    } else {
      console.log('‚úÖ Movies table created or already exists');
      addSampleMovies();
    }
  });
}

function addSampleMovies() {
  // –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∏–ª—å–º–æ–≤ –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞
  const sampleMovies = [
    {
      title: 'Inception',
      description: 'A thief who steals corporate secrets through dream-sharing technology.',
      duration: 148,
      rating: 8.8,
      poster_url: 'https://example.com/inception.jpg',
      genre: 'Sci-Fi',
      release_year: 2010
    },
    {
      title: 'The Dark Knight',
      description: 'Batman faces the Joker in a battle for Gotham City.',
      duration: 152,
      rating: 9.0,
      poster_url: 'https://example.com/dark-knight.jpg',
      genre: 'Action',
      release_year: 2008
    },
    {
      title: 'Interstellar',
      description: 'A team of explorers travel through a wormhole in space.',
      duration: 169,
      rating: 8.6,
      poster_url: 'https://example.com/interstellar.jpg',
      genre: 'Sci-Fi',
      release_year: 2014
    }
  ];

  sampleMovies.forEach(movie => {
    db.run(`
      INSERT OR IGNORE INTO movies (title, description, duration, rating, poster_url, genre, release_year)
      VALUES (?, ?, ?, ?, ?, ?, ?)
    `, [
      movie.title,
      movie.description,
      movie.duration,
      movie.rating,
      movie.poster_url,
      movie.genre,
      movie.release_year
    ]);
  });

  console.log('‚úÖ Sample movies added');
}

export default db;
</file>

<file path="backend/movies-service/src/routes/movies.js">
import express from 'express';
import db from '../database.js';

const router = express.Router();

// –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ñ–∏–ª—å–º—ã
router.get('/', (req, res) => {
  const { page = 1, limit = 10, genre, search } = req.query;
  
  let query = 'SELECT * FROM movies WHERE 1=1';
  const params = [];

  // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∂–∞–Ω—Ä—É
  if (genre) {
    query += ' AND genre = ?';
    params.push(genre);
  }

  // –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
  if (search) {
    query += ' AND title LIKE ?';
    params.push(`%${search}%`);
  }

  // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏—è
  query += ' ORDER BY created_at DESC LIMIT ? OFFSET ?';
  const limitNum = parseInt(limit);
  const offset = (parseInt(page) - 1) * limitNum;
  params.push(limitNum, offset);

  db.all(query, params, (err, movies) => {
    if (err) {
      return res.status(500).json({ error: 'Database error' });
    }

    // –ü–æ–ª—É—á–∞–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
    let countQuery = 'SELECT COUNT(*) as total FROM movies WHERE 1=1';
    const countParams = [];
    
    if (genre) {
      countQuery += ' AND genre = ?';
      countParams.push(genre);
    }
    
    if (search) {
      countQuery += ' AND title LIKE ?';
      countParams.push(`%${search}%`);
    }

    db.get(countQuery, countParams, (err, countResult) => {
      if (err) {
        return res.status(500).json({ error: 'Database error' });
      }

      res.json({
        movies,
        pagination: {
          page: parseInt(page),
          limit: limitNum,
          total: countResult.total,
          pages: Math.ceil(countResult.total / limitNum)
        }
      });
    });
  });
});

// –ü–æ–ª—É—á–∏—Ç—å —Ñ–∏–ª—å–º –ø–æ ID
router.get('/:id', (req, res) => {
  const { id } = req.params;

  db.get('SELECT * FROM movies WHERE id = ?', [id], (err, movie) => {
    if (err) {
      return res.status(500).json({ error: 'Database error' });
    }

    if (!movie) {
      return res.status(404).json({ error: 'Movie not found' });
    }

    res.json({ movie });
  });
});

// –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∂–∞–Ω—Ä—ã
router.get('/genres/list', (req, res) => {
  db.all('SELECT DISTINCT genre FROM movies ORDER BY genre', (err, genres) => {
    if (err) {
      return res.status(500).json({ error: 'Database error' });
    }

    res.json({ 
      genres: genres.map(g => g.genre).filter(g => g) 
    });
  });
});

// –ü–æ–∏—Å–∫ —Ñ–∏–ª—å–º–æ–≤
router.get('/search/query', (req, res) => {
  const { q: query, genre, minRating, maxRating, year } = req.query;

  if (!query) {
    return res.status(400).json({ error: 'Search query is required' });
  }

  let sql = `
    SELECT * FROM movies 
    WHERE (title LIKE ? OR description LIKE ?)
  `;
  const params = [`%${query}%`, `%${query}%`];

  if (genre) {
    sql += ' AND genre = ?';
    params.push(genre);
  }

  if (minRating) {
    sql += ' AND rating >= ?';
    params.push(parseFloat(minRating));
  }

  if (maxRating) {
    sql += ' AND rating <= ?';
    params.push(parseFloat(maxRating));
  }

  if (year) {
    sql += ' AND release_year = ?';
    params.push(parseInt(year));
  }

  sql += ' ORDER BY rating DESC LIMIT 50';

  db.all(sql, params, (err, movies) => {
    if (err) {
      return res.status(500).json({ error: 'Database error' });
    }

    res.json({ 
      query,
      movies,
      count: movies.length 
    });
  });
});

// –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ñ–∏–ª—å–º—ã
router.get('/popular', (req, res) => {
  const { limit = 10 } = req.query;

  db.all(
    'SELECT * FROM movies ORDER BY rating DESC LIMIT ?',
    [parseInt(limit)],
    (err, movies) => {
      if (err) {
        return res.status(500).json({ error: 'Database error' });
      }

      res.json({ movies });
    }
  );
});

export default router;
</file>

<file path="backend/payment-service/.env.example">
# Server Configuration
PORT=3003
NODE_ENV=development

# Database Configuration
DB_HOST=localhost
DB_PORT=5432
DB_NAME=cinescope_payments
DB_USER=postgres
DB_PASSWORD=password

# Payment Gateway Configuration
PAYMENT_GATEWAY_URL=https://api.payment-provider.com
PAYMENT_GATEWAY_API_KEY=your-payment-gateway-api-key
PAYMENT_GATEWAY_SECRET=your-payment-gateway-secret

# Security Configuration
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
ENCRYPTION_KEY=your-32-character-encryption-key

# CORS Configuration
FRONTEND_URL=http://localhost:5173
AUTH_SERVICE_URL=http://localhost:3001
</file>

<file path="backend/payment-service/src/database.js">
import sqlite3 from 'sqlite3';
import path from 'path';

const dbPath = path.join(process.cwd(), 'payments.sqlite');

const db = new sqlite3.Database(dbPath, (err) => {
  if (err) {
    console.error('Error opening database:', err.message);
  } else {
    console.log('‚úÖ Connected to SQLite database');
    createTables();
  }
});

function createTables() {
  // –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –ø–ª–∞—Ç–µ–∂–µ–π
  db.run(`
    CREATE TABLE IF NOT EXISTS payments (
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      user_id INTEGER NOT NULL,
      amount REAL NOT NULL,
      currency TEXT DEFAULT 'USD',
      status TEXT DEFAULT 'pending',
      card_last_four TEXT,
      transaction_id TEXT UNIQUE,
      payment_method TEXT,
      description TEXT,
      created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
      updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
    )
  `, (err) => {
    if (err) {
      console.error('Error creating payments table:', err.message);
    } else {
      console.log('‚úÖ Payments table created or already exists');
      addSamplePayments();
    }
  });
}

function addSamplePayments() {
  // –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤ –ø–ª–∞—Ç–µ–∂–µ–π
  const samplePayments = [
    {
      user_id: 1,
      amount: 15.99,
      currency: 'USD',
      status: 'completed',
      card_last_four: '1234',
      transaction_id: 'txn_1234567890',
      payment_method: 'credit_card',
      description: 'Movie ticket - Inception'
    },
    {
      user_id: 2,
      amount: 12.50,
      currency: 'USD',
      status: 'completed',
      card_last_four: '5678',
      transaction_id: 'txn_0987654321',
      payment_method: 'debit_card',
      description: 'Movie ticket - The Dark Knight'
    },
    {
      user_id: 1,
      amount: 18.00,
      currency: 'USD',
      status: 'pending',
      card_last_four: '9012',
      transaction_id: 'txn_1122334455',
      payment_method: 'credit_card',
      description: 'Movie ticket - Interstellar'
    }
  ];

  samplePayments.forEach(payment => {
    db.run(`
      INSERT OR IGNORE INTO payments (user_id, amount, currency, status, card_last_four, transaction_id, payment_method, description)
      VALUES (?, ?, ?, ?, ?, ?, ?, ?)
    `, [
      payment.user_id,
      payment.amount,
      payment.currency,
      payment.status,
      payment.card_last_four,
      payment.transaction_id,
      payment.payment_method,
      payment.description
    ]);
  });

  console.log('‚úÖ Sample payments added');
}

export default db;
</file>

<file path="backend/payment-service/src/index.js">
import express from 'express';
import cors from 'cors';
import helmet from 'helmet';
import morgan from 'morgan';
import dotenv from 'dotenv';
import paymentRoutes from './routes/payments.js';

// –ó–∞–≥—Ä—É–∂–∞–µ–º .env –ü–ï–†–ï–î –≤—Å–µ–º–∏ –∏–º–ø–æ—Ä—Ç–∞–º–∏
dotenv.config();

import './database.js'; // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

const app = express();
const PORT = process.env.PORT || 3003;

// Middleware
app.use(helmet());
app.use(cors({
  origin: process.env.FRONTEND_URL || 'http://localhost:5173',
  credentials: true
}));
app.use(morgan('combined'));
app.use(express.json());

// Rate limiting middleware (–ø—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
const rateLimit = {};
app.use((req, res, next) => {
  const key = req.ip;
  const now = Date.now();
  const windowMs = 60 * 1000; // 1 –º–∏–Ω—É—Ç–∞
  const maxRequests = 100;

  if (!rateLimit[key]) {
    rateLimit[key] = { count: 0, resetTime: now + windowMs };
  }

  if (now > rateLimit[key].resetTime) {
    rateLimit[key] = { count: 0, resetTime: now + windowMs };
  }

  rateLimit[key].count++;

  if (rateLimit[key].count > maxRequests) {
    return res.status(429).json({
      error: 'Too many requests',
      message: `Rate limit exceeded. Max ${maxRequests} requests per minute.`,
      retryAfter: Math.ceil((rateLimit[key].resetTime - now) / 1000)
    });
  }

  next();
});

// Routes
app.use('/payment', paymentRoutes);

// Health check
app.get('/health', (req, res) => {
  res.json({ 
    status: 'OK', 
    service: 'payment-service',
    timestamp: new Date().toISOString(),
    version: '1.0.0',
    uptime: process.uptime()
  });
});

// Root endpoint
app.get('/', (req, res) => {
  res.json({
    message: 'üí≥ Payment Service API',
    version: '1.0.0',
    description: 'Secure payment processing service for CineScope',
    endpoints: {
      health: '/health',
      validateCard: '/payment/validate-card',
      createPayment: '/payment/create',
      paymentStatus: '/payment/status/:transactionId',
      paymentHistory: '/payment/history/:userId',
      refund: '/payment/refund',
      statistics: '/payment/stats'
    },
    security: {
      rateLimit: '100 requests per minute',
      encryption: 'AES-256',
      compliance: 'PCI DSS'
    }
  });
});

// Error handling middleware
app.use((err, req, res, next) => {
  console.error('Payment Service Error:', err.stack);
  res.status(500).json({ 
    error: 'Payment processing error',
    message: process.env.NODE_ENV === 'development' ? err.message : undefined,
    transactionId: null // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã ID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
  });
});

// 404 handler
app.use((req, res) => {
  res.status(404).json({ 
    error: 'Not Found',
    message: `Route ${req.originalUrl} not found`,
    availableEndpoints: [
      '/health',
      '/payment/validate-card',
      '/payment/create',
      '/payment/status/:transactionId',
      '/payment/history/:userId',
      '/payment/refund',
      '/payment/stats'
    ]
  });
});

// Graceful shutdown
process.on('SIGTERM', () => {
  console.log('SIGTERM received, shutting down gracefully');
  process.exit(0);
});

process.on('SIGINT', () => {
  console.log('SIGINT received, shutting down gracefully');
  process.exit(0);
});

// Start server
app.listen(PORT, () => {
  console.log(`üí≥ Payment Service running on port ${PORT}`);
  console.log(`üìä Health check: http://localhost:${PORT}/health`);
  console.log(`üí≥ Payment API: http://localhost:${PORT}/payment`);
  console.log(`üîí Security: Rate limiting enabled (100 req/min)`);
  console.log(`üîê Encryption: AES-256 enabled`);
  console.log(`‚è±Ô∏è  Uptime: ${process.uptime()}s`);
});

export default app;
</file>

<file path="backend/payment-service/src/routes/payments.js">
import express from 'express';
import db from '../database.js';
import { validateCard, generateTransactionId } from '../utils/cardValidator.js';

const router = express.Router();

// –í–∞–ª–∏–¥–∞—Ü–∏—è –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –∫–∞—Ä—Ç—ã
router.post('/validate-card', (req, res) => {
  const { cardNumber, cvv, expiryMonth, expiryYear, cardholderName } = req.body;

  if (!cardNumber || !cvv || !expiryMonth || !expiryYear) {
    return res.status(400).json({ 
      error: 'Missing required fields',
      required: ['cardNumber', 'cvv', 'expiryMonth', 'expiryYear']
    });
  }

  const validation = validateCard({
    cardNumber,
    cvv,
    expiryMonth,
    expiryYear
  });

  res.json({
    valid: validation.valid,
    cardType: validation.results.cardType,
    maskedNumber: validation.results.maskedNumber,
    errors: validation.errors,
    timestamp: new Date().toISOString()
  });
});

// –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
router.post('/create', async (req, res) => {
  const { 
    userId, 
    amount, 
    currency = 'USD',
    cardNumber, 
    cvv, 
    expiryMonth, 
    expiryYear,
    description 
  } = req.body;

  if (!userId || !amount || !cardNumber || !cvv || !expiryMonth || !expiryYear) {
    return res.status(400).json({ 
      error: 'Missing required fields',
      required: ['userId', 'amount', 'cardNumber', 'cvv', 'expiryMonth', 'expiryYear']
    });
  }

  // –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–∞—Ä—Ç—ã
  const cardValidation = validateCard({
    cardNumber,
    cvv,
    expiryMonth,
    expiryYear
  });

  if (!cardValidation.valid) {
    return res.status(400).json({
      error: 'Invalid card details',
      errors: cardValidation.errors,
      cardType: cardValidation.results.cardType
    });
  }

  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è transaction ID
  const transactionId = generateTransactionId();
  const cardLastFour = cardValidation.results.maskedNumber.slice(-4);

  // –ò–º–∏—Ç–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–∞ (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∑–¥–µ—Å—å –±—ã–ª –±—ã –≤—ã–∑–æ–≤ –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —à–ª—é–∑–∞)
  setTimeout(() => {
    // –°–ª—É—á–∞–π–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
    const isSuccess = Math.random() > 0.1; // 90% —É—Å–ø–µ—Ö
    const status = isSuccess ? 'completed' : 'failed';
    const failureReason = isSuccess ? null : 'Insufficient funds';

    db.run(`
      INSERT INTO payments (user_id, amount, currency, status, card_last_four, transaction_id, payment_method, description)
      VALUES (?, ?, ?, ?, ?, ?, ?, ?)
    `, [
      userId,
      amount,
      currency,
      status,
      cardLastFour,
      transactionId,
      'credit_card',
      description || 'Movie ticket purchase'
    ], function(err) {
      if (err) {
        console.error('Error creating payment:', err);
        return;
      }

      console.log(`Payment ${status}: ${transactionId} for user ${userId}, amount $${amount}`);
    });
  }, 2000); // 2 —Å–µ–∫—É–Ω–¥—ã –∏–º–∏—Ç–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

  // –°—Ä–∞–∑—É –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—Ç–≤–µ—Ç —Å pending —Å—Ç–∞—Ç—É—Å–æ–º
  res.status(201).json({
    message: 'Payment processing initiated',
    transactionId,
    status: 'pending',
    amount,
    currency,
    cardType: cardValidation.results.cardType,
    maskedCardNumber: cardValidation.results.maskedNumber,
    estimatedProcessingTime: '2 seconds'
  });
});

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞
router.get('/status/:transactionId', (req, res) => {
  const { transactionId } = req.params;

  db.get(
    'SELECT * FROM payments WHERE transaction_id = ?',
    [transactionId],
    (err, payment) => {
      if (err) {
        return res.status(500).json({ error: 'Database error' });
      }

      if (!payment) {
        return res.status(404).json({ error: 'Transaction not found' });
      }

      res.json({
        transactionId: payment.transaction_id,
        status: payment.status,
        amount: payment.amount,
        currency: payment.currency,
        createdAt: payment.created_at,
        updatedAt: payment.updated_at,
        cardLastFour: payment.card_last_four,
        description: payment.description
      });
    }
  );
});

// –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
router.get('/history/:userId', (req, res) => {
  const { userId } = req.params;
  const { page = 1, limit = 10, status } = req.query;

  let query = 'SELECT * FROM payments WHERE user_id = ?';
  const params = [userId];

  if (status) {
    query += ' AND status = ?';
    params.push(status);
  }

  query += ' ORDER BY created_at DESC LIMIT ? OFFSET ?';
  const limitNum = parseInt(limit);
  const offset = (parseInt(page) - 1) * limitNum;
  params.push(limitNum, offset);

  db.all(query, params, (err, payments) => {
    if (err) {
      return res.status(500).json({ error: 'Database error' });
    }

    // –ü–æ–ª—É—á–∞–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
    let countQuery = 'SELECT COUNT(*) as total FROM payments WHERE user_id = ?';
    const countParams = [userId];
    
    if (status) {
      countQuery += ' AND status = ?';
      countParams.push(status);
    }

    db.get(countQuery, countParams, (err, countResult) => {
      if (err) {
        return res.status(500).json({ error: 'Database error' });
      }

      res.json({
        userId: parseInt(userId),
        payments: payments.map(p => ({
          transactionId: p.transaction_id,
          amount: p.amount,
          currency: p.currency,
          status: p.status,
          cardLastFour: p.card_last_four,
          description: p.description,
          createdAt: p.created_at,
          updatedAt: p.updated_at
        })),
        pagination: {
          page: parseInt(page),
          limit: limitNum,
          total: countResult.total,
          pages: Math.ceil(countResult.total / limitNum)
        }
      });
    });
  });
});

// –í–æ–∑–≤—Ä–∞—Ç –ø–ª–∞—Ç–µ–∂–∞
router.post('/refund', (req, res) => {
  const { transactionId, reason } = req.body;

  if (!transactionId) {
    return res.status(400).json({ 
      error: 'Transaction ID is required' 
    });
  }

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–ª–∞—Ç–µ–∂ –∏ –º–æ–∂–Ω–æ –ª–∏ –µ–≥–æ –≤–µ—Ä–Ω—É—Ç—å
  db.get(
    'SELECT * FROM payments WHERE transaction_id = ? AND status = "completed"',
    [transactionId],
    (err, payment) => {
      if (err) {
        return res.status(500).json({ error: 'Database error' });
      }

      if (!payment) {
        return res.status(404).json({ 
          error: 'Completed transaction not found' 
        });
      }

      // –°–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å –æ –≤–æ–∑–≤—Ä–∞—Ç–µ
      const refundTransactionId = generateTransactionId();
      
      db.run(`
        INSERT INTO payments (user_id, amount, currency, status, card_last_four, transaction_id, payment_method, description)
        VALUES (?, ?, ?, ?, ?, ?, ?, ?)
      `, [
        payment.user_id,
        -payment.amount, // –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è —Å—É–º–º–∞ –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞
        payment.currency,
        'refunded',
        payment.card_last_four,
        refundTransactionId,
        'refund',
        `Refund for transaction ${transactionId}${reason ? ': ' + reason : ''}`
      ], function(err) {
        if (err) {
          return res.status(500).json({ error: 'Database error' });
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞
        db.run(
          'UPDATE payments SET status = "refunded", updated_at = CURRENT_TIMESTAMP WHERE transaction_id = ?',
          [transactionId]
        );

        res.json({
          message: 'Refund processed successfully',
          originalTransactionId: transactionId,
          refundTransactionId,
          refundedAmount: payment.amount,
          currency: payment.currency,
          reason: reason || 'Customer request'
        });
      });
    }
  );
});

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π
router.get('/stats', (req, res) => {
  const { startDate, endDate } = req.query;

  let query = `
    SELECT 
      COUNT(*) as totalTransactions,
      SUM(CASE WHEN status = 'completed' THEN amount ELSE 0 END) as totalRevenue,
      SUM(CASE WHEN status = 'pending' THEN 1 ELSE 0 END) as pendingTransactions,
      SUM(CASE WHEN status = 'failed' THEN 1 ELSE 0 END) as failedTransactions,
      AVG(amount) as averageTransactionAmount
    FROM payments
    WHERE 1=1
  `;
  const params = [];

  if (startDate) {
    query += ' AND created_at >= ?';
    params.push(startDate);
  }

  if (endDate) {
    query += ' AND created_at <= ?';
    params.push(endDate);
  }

  db.get(query, params, (err, stats) => {
    if (err) {
      return res.status(500).json({ error: 'Database error' });
    }

    res.json({
      period: {
        startDate: startDate || 'all time',
        endDate: endDate || 'now'
      },
      statistics: {
        totalTransactions: stats.totalTransactions || 0,
        totalRevenue: stats.totalRevenue || 0,
        pendingTransactions: stats.pendingTransactions || 0,
        failedTransactions: stats.failedTransactions || 0,
        averageTransactionAmount: stats.averageTransactionAmount || 0
      }
    });
  });
});

export default router;
</file>

<file path="backend/payment-service/src/utils/cardValidator.js">
import crypto from 'crypto';

// –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–æ–º–µ—Ä–∞ –∫–∞—Ä—Ç—ã –ø–æ –∞–ª–≥–æ—Ä–∏—Ç–º—É –õ—É–Ω–∞
export function validateCardNumber(cardNumber) {
  // –£–¥–∞–ª—è–µ–º –≤—Å–µ –Ω–µ—Ü–∏—Ñ—Ä–æ–≤—ã–µ —Å–∏–º–≤–æ–ª—ã
  const cleaned = cardNumber.replace(/\D/g, '');
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–∑–æ–≤—É—é –¥–ª–∏–Ω—É
  if (cleaned.length < 13 || cleaned.length > 19) {
    return { valid: false, error: 'Invalid card length' };
  }

  // –ê–ª–≥–æ—Ä–∏—Ç–º –õ—É–Ω–∞
  let sum = 0;
  let isEven = false;
  
  for (let i = cleaned.length - 1; i >= 0; i--) {
    let digit = parseInt(cleaned[i]);
    
    if (isEven) {
      digit *= 2;
      if (digit > 9) {
        digit -= 9;
      }
    }
    
    sum += digit;
    isEven = !isEven;
  }
  
  const isValid = sum % 10 === 0;
  
  return {
    valid: isValid,
    error: isValid ? null : 'Invalid card number (Luhn check failed)'
  };
}

// –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –∫–∞—Ä—Ç—ã
export function getCardType(cardNumber) {
  const cleaned = cardNumber.replace(/\D/g, '');
  
  // Visa
  if (/^4/.test(cleaned)) {
    return 'visa';
  }
  
  // MasterCard
  if (/^5[1-5]/.test(cleaned)) {
    return 'mastercard';
  }
  
  // American Express
  if (/^3[47]/.test(cleaned)) {
    return 'amex';
  }
  
  // Discover
  if (/^6(?:011|5[0-9]{2})/.test(cleaned)) {
    return 'discover';
  }
  
  return 'unknown';
}

// –í–∞–ª–∏–¥–∞—Ü–∏—è CVV
export function validateCVV(cvv, cardType) {
  const cleaned = cvv.replace(/\D/g, '');
  
  if (cardType === 'amex') {
    return {
      valid: cleaned.length === 4,
      error: cleaned.length === 4 ? null : 'Amex CVV must be 4 digits'
    };
  }
  
  return {
    valid: cleaned.length === 3,
    error: cleaned.length === 3 ? null : 'CVV must be 3 digits'
  };
}

// –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
export function validateExpiry(month, year) {
  const now = new Date();
  const currentYear = now.getFullYear();
  const currentMonth = now.getMonth() + 1;
  
  const expMonth = parseInt(month);
  const expYear = parseInt(year);
  
  if (expMonth < 1 || expMonth > 12) {
    return { valid: false, error: 'Invalid month' };
  }
  
  if (expYear < currentYear || (expYear === currentYear && expMonth < currentMonth)) {
    return { valid: false, error: 'Card has expired' };
  }
  
  return { valid: true, error: null };
}

// –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ –Ω–æ–º–µ—Ä–∞ –∫–∞—Ä—Ç—ã
export function maskCardNumber(cardNumber) {
  const cleaned = cardNumber.replace(/\D/g, '');
  const lastFour = cleaned.slice(-4);
  const masked = cleaned.slice(0, -4).replace(/\d/g, '*');
  
  return `${masked}${lastFour}`;
}

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è transaction ID
export function generateTransactionId() {
  return `txn_${Date.now()}_${crypto.randomBytes(4).toString('hex').slice(0, 8)}`;
}

// –ü–æ–ª–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–∞—Ä—Ç—ã
export function validateCard(cardData) {
  const { cardNumber, cvv, expiryMonth, expiryYear } = cardData;
  
  const results = {
    cardNumber: validateCardNumber(cardNumber),
    cardType: getCardType(cardNumber),
    cvv: validateCVV(cvv, getCardType(cardNumber)),
    expiry: validateExpiry(expiryMonth, expiryYear),
    maskedNumber: maskCardNumber(cardNumber)
  };
  
  const isValid = Object.values(results).every(result => 
    typeof result === 'string' || result.valid
  );
  
  return {
    valid: isValid,
    results,
    errors: Object.values(results)
      .filter(result => result.error)
      .map(result => result.error)
  };
}
</file>

<file path="docker-compose.yml">
version: '3.8'

services:
  # API Gateway
  api-gateway:
    build:
      context: ./backend/api-gateway
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
    environment:
      - NODE_ENV=production
      - PORT=8080
      - AUTH_SERVICE_URL=http://auth-service:3001
      - MOVIES_SERVICE_URL=http://movies-service:3002
      - PAYMENT_SERVICE_URL=http://payment-service:3003
      - FRONTEND_URL=http://localhost
      - ALLOWED_ORIGINS=http://localhost,http://localhost:80,http://localhost:443
      - SWAGGER_ENABLED=true
    networks:
      - cinescope-network
    depends_on:
      - auth-service
      - movies-service
      - payment-service
    restart: unless-stopped

  # Auth Service
  auth-service:
    build:
      context: ./backend/auth-service
      dockerfile: Dockerfile
    ports:
      - "3001:3001"
    environment:
      - NODE_ENV=production
      - PORT=3001
      - JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
      - JWT_EXPIRES_IN=24h
    volumes:
      - auth-data:/app/data
    networks:
      - cinescope-network
    restart: unless-stopped

  # Movies Service
  movies-service:
    build:
      context: ./backend/movies-service
      dockerfile: Dockerfile
    ports:
      - "3002:3002"
    environment:
      - NODE_ENV=production
      - PORT=3002
    volumes:
      - movies-data:/app/data
    networks:
      - cinescope-network
    restart: unless-stopped

  # Payment Service
  payment-service:
    build:
      context: ./backend/payment-service
      dockerfile: Dockerfile
    ports:
      - "3003:3003"
    environment:
      - NODE_ENV=production
      - PORT=3003
      - PAYMENT_GATEWAY_URL=https://api.payment-provider.com
      - PAYMENT_GATEWAY_API_KEY=your-payment-gateway-api-key
      - PAYMENT_GATEWAY_SECRET=your-payment-gateway-secret
      - JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
      - ENCRYPTION_KEY=your-32-character-encryption-key
    volumes:
      - payment-data:/app/data
    networks:
      - cinescope-network
    restart: unless-stopped

  # Nginx Reverse Proxy
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./frontend-vite/dist:/usr/share/nginx/html:ro
      - nginx-logs:/var/log/nginx
    networks:
      - cinescope-network
    depends_on:
      - api-gateway
    restart: unless-stopped

volumes:
  auth-data:
    driver: local
  movies-data:
    driver: local
  payment-data:
    driver: local
  nginx-logs:
    driver: local

networks:
  cinescope-network:
    driver: bridge
</file>

<file path="frontend/.env.example">
# API Configuration
VITE_API_URL=http://localhost:8080

# Application Configuration
VITE_APP_NAME=CineScope
VITE_APP_VERSION=1.0.0

# Feature Flags
VITE_ENABLE_ANALYTICS=false
VITE_ENABLE_DEBUG=true

# External Services
VITE_STRIPE_PUBLIC_KEY=pk_test_your_stripe_public_key
VITE_GOOGLE_ANALYTICS_ID=GA-XXXXXXXXX
</file>

<file path="frontend/eslint.config.js">
import js from '@eslint/js'
import globals from 'globals'
import reactHooks from 'eslint-plugin-react-hooks'
import reactRefresh from 'eslint-plugin-react-refresh'
import tseslint from 'typescript-eslint'
import { defineConfig, globalIgnores } from 'eslint/config'

export default defineConfig([
  globalIgnores(['dist']),
  {
    files: ['**/*.{ts,tsx}'],
    extends: [
      js.configs.recommended,
      tseslint.configs.recommended,
      reactHooks.configs.flat.recommended,
      reactRefresh.configs.vite,
    ],
    languageOptions: {
      ecmaVersion: 2020,
      globals: globals.browser,
    },
  },
])
</file>

<file path="frontend/index.html">
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>frontend-vite</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
</file>

<file path="frontend/public/vite.svg">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--logos" width="31.88" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 257"><defs><linearGradient id="IconifyId1813088fe1fbc01fb466" x1="-.828%" x2="57.636%" y1="7.652%" y2="78.411%"><stop offset="0%" stop-color="#41D1FF"></stop><stop offset="100%" stop-color="#BD34FE"></stop></linearGradient><linearGradient id="IconifyId1813088fe1fbc01fb467" x1="43.376%" x2="50.316%" y1="2.242%" y2="89.03%"><stop offset="0%" stop-color="#FFEA83"></stop><stop offset="8.333%" stop-color="#FFDD35"></stop><stop offset="100%" stop-color="#FFA800"></stop></linearGradient></defs><path fill="url(#IconifyId1813088fe1fbc01fb466)" d="M255.153 37.938L134.897 252.976c-2.483 4.44-8.862 4.466-11.382.048L.875 37.958c-2.746-4.814 1.371-10.646 6.827-9.67l120.385 21.517a6.537 6.537 0 0 0 2.322-.004l117.867-21.483c5.438-.991 9.574 4.796 6.877 9.62Z"></path><path fill="url(#IconifyId1813088fe1fbc01fb467)" d="M185.432.063L96.44 17.501a3.268 3.268 0 0 0-2.634 3.014l-5.474 92.456a3.268 3.268 0 0 0 3.997 3.378l24.777-5.718c2.318-.535 4.413 1.507 3.936 3.838l-7.361 36.047c-.495 2.426 1.782 4.5 4.151 3.78l15.304-4.649c2.372-.72 4.652 1.36 4.15 3.788l-11.698 56.621c-.732 3.542 3.979 5.473 5.943 2.437l1.313-2.028l72.516-144.72c1.215-2.423-.88-5.186-3.54-4.672l-25.505 4.922c-2.396.462-4.435-1.77-3.759-4.114l16.646-57.705c.677-2.35-1.37-4.583-3.769-4.113Z"></path></svg>
</file>

<file path="frontend/src/assets/react.svg">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--logos" width="35.93" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 228"><path fill="#00D8FF" d="M210.483 73.824a171.49 171.49 0 0 0-8.24-2.597c.465-1.9.893-3.777 1.273-5.621c6.238-30.281 2.16-54.676-11.769-62.708c-13.355-7.7-35.196.329-57.254 19.526a171.23 171.23 0 0 0-6.375 5.848a155.866 155.866 0 0 0-4.241-3.917C100.759 3.829 77.587-4.822 63.673 3.233C50.33 10.957 46.379 33.89 51.995 62.588a170.974 170.974 0 0 0 1.892 8.48c-3.28.932-6.445 1.924-9.474 2.98C17.309 83.498 0 98.307 0 113.668c0 15.865 18.582 31.778 46.812 41.427a145.52 145.52 0 0 0 6.921 2.165a167.467 167.467 0 0 0-2.01 9.138c-5.354 28.2-1.173 50.591 12.134 58.266c13.744 7.926 36.812-.22 59.273-19.855a145.567 145.567 0 0 0 5.342-4.923a168.064 168.064 0 0 0 6.92 6.314c21.758 18.722 43.246 26.282 56.54 18.586c13.731-7.949 18.194-32.003 12.4-61.268a145.016 145.016 0 0 0-1.535-6.842c1.62-.48 3.21-.974 4.76-1.488c29.348-9.723 48.443-25.443 48.443-41.52c0-15.417-17.868-30.326-45.517-39.844Zm-6.365 70.984c-1.4.463-2.836.91-4.3 1.345c-3.24-10.257-7.612-21.163-12.963-32.432c5.106-11 9.31-21.767 12.459-31.957c2.619.758 5.16 1.557 7.61 2.4c23.69 8.156 38.14 20.213 38.14 29.504c0 9.896-15.606 22.743-40.946 31.14Zm-10.514 20.834c2.562 12.94 2.927 24.64 1.23 33.787c-1.524 8.219-4.59 13.698-8.382 15.893c-8.067 4.67-25.32-1.4-43.927-17.412a156.726 156.726 0 0 1-6.437-5.87c7.214-7.889 14.423-17.06 21.459-27.246c12.376-1.098 24.068-2.894 34.671-5.345a134.17 134.17 0 0 1 1.386 6.193ZM87.276 214.515c-7.882 2.783-14.16 2.863-17.955.675c-8.075-4.657-11.432-22.636-6.853-46.752a156.923 156.923 0 0 1 1.869-8.499c10.486 2.32 22.093 3.988 34.498 4.994c7.084 9.967 14.501 19.128 21.976 27.15a134.668 134.668 0 0 1-4.877 4.492c-9.933 8.682-19.886 14.842-28.658 17.94ZM50.35 144.747c-12.483-4.267-22.792-9.812-29.858-15.863c-6.35-5.437-9.555-10.836-9.555-15.216c0-9.322 13.897-21.212 37.076-29.293c2.813-.98 5.757-1.905 8.812-2.773c3.204 10.42 7.406 21.315 12.477 32.332c-5.137 11.18-9.399 22.249-12.634 32.792a134.718 134.718 0 0 1-6.318-1.979Zm12.378-84.26c-4.811-24.587-1.616-43.134 6.425-47.789c8.564-4.958 27.502 2.111 47.463 19.835a144.318 144.318 0 0 1 3.841 3.545c-7.438 7.987-14.787 17.08-21.808 26.988c-12.04 1.116-23.565 2.908-34.161 5.309a160.342 160.342 0 0 1-1.76-7.887Zm110.427 27.268a347.8 347.8 0 0 0-7.785-12.803c8.168 1.033 15.994 2.404 23.343 4.08c-2.206 7.072-4.956 14.465-8.193 22.045a381.151 381.151 0 0 0-7.365-13.322Zm-45.032-43.861c5.044 5.465 10.096 11.566 15.065 18.186a322.04 322.04 0 0 0-30.257-.006c4.974-6.559 10.069-12.652 15.192-18.18ZM82.802 87.83a323.167 323.167 0 0 0-7.227 13.238c-3.184-7.553-5.909-14.98-8.134-22.152c7.304-1.634 15.093-2.97 23.209-3.984a321.524 321.524 0 0 0-7.848 12.897Zm8.081 65.352c-8.385-.936-16.291-2.203-23.593-3.793c2.26-7.3 5.045-14.885 8.298-22.6a321.187 321.187 0 0 0 7.257 13.246c2.594 4.48 5.28 8.868 8.038 13.147Zm37.542 31.03c-5.184-5.592-10.354-11.779-15.403-18.433c4.902.192 9.899.29 14.978.29c5.218 0 10.376-.117 15.453-.343c-4.985 6.774-10.018 12.97-15.028 18.486Zm52.198-57.817c3.422 7.8 6.306 15.345 8.596 22.52c-7.422 1.694-15.436 3.058-23.88 4.071a382.417 382.417 0 0 0 7.859-13.026a347.403 347.403 0 0 0 7.425-13.565Zm-16.898 8.101a358.557 358.557 0 0 1-12.281 19.815a329.4 329.4 0 0 1-23.444.823c-7.967 0-15.716-.248-23.178-.732a310.202 310.202 0 0 1-12.513-19.846h.001a307.41 307.41 0 0 1-10.923-20.627a310.278 310.278 0 0 1 10.89-20.637l-.001.001a307.318 307.318 0 0 1 12.413-19.761c7.613-.576 15.42-.876 23.31-.876H128c7.926 0 15.743.303 23.354.883a329.357 329.357 0 0 1 12.335 19.695a358.489 358.489 0 0 1 11.036 20.54a329.472 329.472 0 0 1-11 20.722Zm22.56-122.124c8.572 4.944 11.906 24.881 6.52 51.026c-.344 1.668-.73 3.367-1.15 5.09c-10.622-2.452-22.155-4.275-34.23-5.408c-7.034-10.017-14.323-19.124-21.64-27.008a160.789 160.789 0 0 1 5.888-5.4c18.9-16.447 36.564-22.941 44.612-18.3ZM128 90.808c12.625 0 22.86 10.235 22.86 22.86s-10.235 22.86-22.86 22.86s-22.86-10.235-22.86-22.86s10.235-22.86 22.86-22.86Z"></path></svg>
</file>

<file path="frontend/src/components/Footer.tsx">
import React from 'react';

const Footer: React.FC = () => {
  return (
    <footer className="bg-gray-900 text-gray-400 mt-auto">
      <div className="container mx-auto px-4 py-8">
        <div className="grid grid-cols-1 md:grid-cols-4 gap-8">
          {/* –û –∫–æ–º–ø–∞–Ω–∏–∏ */}
          <div>
            <div className="flex items-center space-x-2 mb-4">
              <div className="w-8 h-8 bg-red-600 rounded-lg flex items-center justify-center">
                <span className="text-white font-bold text-xl">C</span>
              </div>
              <span className="text-white font-bold text-xl">CineScope</span>
            </div>
            <p className="text-sm">
              –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –æ–Ω–ª–∞–π–Ω-–∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä —Å —É–¥–æ–±–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –ø–æ–∫—É–ø–∫–∏ –±–∏–ª–µ—Ç–æ–≤
            </p>
          </div>

          {/* –ù–∞–≤–∏–≥–∞—Ü–∏—è */}
          <div>
            <h3 className="text-white font-semibold mb-4">–ù–∞–≤–∏–≥–∞—Ü–∏—è</h3>
            <ul className="space-y-2 text-sm">
              <li><a href="/" className="hover:text-white transition-colors">–ì–ª–∞–≤–Ω–∞—è</a></li>
              <li><a href="/movies" className="hover:text-white transition-colors">–§–∏–ª—å–º—ã</a></li>
              <li><a href="/sessions" className="hover:text-white transition-colors">–°–µ–∞–Ω—Å—ã</a></li>
              <li><a href="/profile" className="hover:text-white transition-colors">–ü—Ä–æ—Ñ–∏–ª—å</a></li>
            </ul>
          </div>

          {/* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ */}
          <div>
            <h3 className="text-white font-semibold mb-4">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</h3>
            <ul className="space-y-2 text-sm">
              <li><a href="/help" className="hover:text-white transition-colors">–ü–æ–º–æ—â—å</a></li>
              <li><a href="/faq" className="hover:text-white transition-colors">FAQ</a></li>
              <li><a href="/contacts" className="hover:text-white transition-colors">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
              <li><a href="/terms" className="hover:text-white transition-colors">–£—Å–ª–æ–≤–∏—è</a></li>
            </ul>
          </div>

          {/* –ö–æ–Ω—Ç–∞–∫—Ç—ã */}
          <div>
            <h3 className="text-white font-semibold mb-4">–ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
            <ul className="space-y-2 text-sm">
              <li>support@cinescope.store</li>
              <li>+7 (999) 123-45-67</li>
              <li>–ï–∂–µ–¥–Ω–µ–≤–Ω–æ —Å 9:00 –¥–æ 21:00</li>
            </ul>
          </div>
        </div>

        {/* –ù–∏–∂–Ω—è—è —á–∞—Å—Ç—å */}
        <div className="border-t border-gray-800 mt-8 pt-8 text-center text-sm">
          <p>&copy; 2024 CineScope. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
        </div>
      </div>
    </footer>
  );
};

export default Footer;
</file>

<file path="frontend/src/components/Header.tsx">
import React from 'react';
import { Link } from 'react-router-dom';

const Header: React.FC = () => {
  return (
    <header className="bg-gray-900 text-white shadow-lg">
      <div className="container mx-auto px-4">
        <div className="flex items-center justify-between h-16">
          {/* –õ–æ–≥–æ—Ç–∏–ø */}
          <Link to="/" className="flex items-center space-x-2">
            <div className="w-8 h-8 bg-red-600 rounded-lg flex items-center justify-center">
              <span className="text-white font-bold text-xl">C</span>
            </div>
            <span className="text-xl font-bold">CineScope</span>
          </Link>

          {/* –ù–∞–≤–∏–≥–∞—Ü–∏—è */}
          <nav className="hidden md:flex space-x-8">
            <Link 
              to="/" 
              className="text-gray-300 hover:text-white transition-colors duration-200"
            >
              –ì–ª–∞–≤–Ω–∞—è
            </Link>
            <Link 
              to="/movies" 
              className="text-gray-300 hover:text-white transition-colors duration-200"
            >
              –§–∏–ª—å–º—ã
            </Link>
            <Link 
              to="/sessions" 
              className="text-gray-300 hover:text-white transition-colors duration-200"
            >
              –°–µ–∞–Ω—Å—ã
            </Link>
          </nav>

          {/* –ö–Ω–æ–ø–∫–∏ –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ */}
          <div className="flex items-center space-x-4">
            <button className="text-gray-300 hover:text-white transition-colors duration-200">
              –í—Ö–æ–¥
            </button>
            <button className="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors duration-200">
              –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
            </button>
          </div>
        </div>
      </div>
    </header>
  );
};

export default Header;
</file>

<file path="frontend/src/main.tsx">
import { StrictMode } from 'react'
import { createRoot } from 'react-dom/client'
import './index.css'
import App from './App.tsx'

createRoot(document.getElementById('root')!).render(
  <StrictMode>
    <App />
  </StrictMode>,
)
</file>

<file path="frontend/src/pages/MovieDetailPage.tsx">
import React, { useState, useEffect } from 'react';
import { useParams, Link } from 'react-router-dom';
import { movieService, type Movie } from '../services/movieService';
import { paymentService } from '../services/paymentService';
import { authService } from '../services/authService';

const MovieDetailPage: React.FC = () => {
  const { id } = useParams<{ id: string }>();
  const [movie, setMovie] = useState<Movie | null>(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  const handleBuyTicket = async () => {
    if (!authService.isAuthenticated()) {
      alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É');
      return;
    }

    try {
      const user = authService.getCurrentUser();
      await paymentService.createPayment({
        userId: user?.id || 0,
        amount: movie?.rating || 100,
        currency: 'RUB',
        description: `–ë–∏–ª–µ—Ç –Ω–∞ —Ñ–∏–ª—å–º: ${movie?.title}`,
        cardData: {
          cardNumber: '4242424242424242',
          cvv: '123',
          expiryMonth: '12',
          expiryYear: '25'
        }
      });
      alert('–ë–∏–ª–µ—Ç —É—Å–ø–µ—à–Ω–æ –∫—É–ø–ª–µ–Ω!');
    } catch (e) {
      alert('–û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏ –±–∏–ª–µ—Ç–∞: ' + (e as Error).message);
    }
  };

  const handleAddToFavorites = () => {
    if (!authService.isAuthenticated()) {
      alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É');
      return;
    }
    alert(`–§–∏–ª—å–º "${movie?.title}" –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ`);
  };

  useEffect(() => {
    const fetchMovie = async () => {
      if (!id) return; // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ id —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
      
      try {
        setLoading(true);
        const response = await movieService.getMovieById(id);
        setMovie(response);
        setError(null);
      } catch (err) {
        setError('Failed to fetch movie');
        console.error('Error fetching movie:', err);
      } finally {
        setLoading(false);
      }
    };

    fetchMovie();
  }, [id]);

  if (loading) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="text-center">
          <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"></div>
          <p className="text-gray-600">–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∏–ª—å–º–∞...</p>
        </div>
      </div>
    );
  }

  if (error) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="text-center">
          <div className="text-red-600 text-xl mb-4">‚ö†Ô∏è –û—à–∏–±–∫–∞</div>
          <p className="text-gray-600">{error}</p>
          <Link 
            to="/movies"
            className="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg"
          >
            –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ñ–∏–ª—å–º–∞–º
          </Link>
        </div>
      </div>
    );
  }

  if (!movie) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="text-center">
          <div className="text-gray-500 text-xl mb-4">üìΩ –§–∏–ª—å–º –Ω–µ –Ω–∞–π–¥–µ–Ω</div>
          <p className="text-gray-400">–§–∏–ª—å–º —Å ID {id} –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç</p>
          <Link 
            to="/movies"
            className="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg"
          >
            –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ñ–∏–ª—å–º–∞–º
          </Link>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gray-50 py-8">
      <div className="container mx-auto px-4">
        <div className="mb-6">
          <Link 
            to="/movies"
            className="text-blue-600 hover:text-blue-800 flex items-center"
          >
            ‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ñ–∏–ª—å–º–∞–º
          </Link>
        </div>

        <div className="bg-white rounded-lg shadow-lg overflow-hidden">
          <div className="md:flex">
            <div className="md:shrink-0">
              <img 
                src={movie.poster_url} 
                alt={movie.title}
                className="h-96 w-full object-cover"
                onError={(e) => {
                  const target = e.target as HTMLImageElement;
                  target.src = 'https://via.placeholder.com/400x600?text=' + movie.title;
                }}
              />
            </div>
            <div className="p-8">
              <div className="uppercase tracking-wide text-sm text-indigo-600 font-semibold">
                {movie.genre}
              </div>
              <h1 className="mt-4 text-3xl font-bold text-gray-900">
                {movie.title}
              </h1>
              <div className="mt-2 flex items-center">
                <div className="flex items-center">
                  <span className="text-3xl font-bold text-red-600">‚ÇΩ{movie.rating}</span>
                  <span className="text-gray-500">/10</span>
                </div>
                <div className="ml-4 flex items-center space-x-2">
                  <span className="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded">
                    {movie.genre}
                  </span>
                  <span className="text-gray-500 text-sm">
                    {movie.release_year}
                  </span>
                  <span className="text-gray-500 text-sm">
                    {movie.duration} –º–∏–Ω
                  </span>
                </div>
              </div>
              <p className="mt-4 text-gray-600 leading-relaxed">
                {movie.description}
              </p>
              <div className="mt-8 flex space-x-4">
                <button 
                  onClick={handleBuyTicket}
                  className="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-semibold"
                >
                  –ö—É–ø–∏—Ç—å –±–∏–ª–µ—Ç
                </button>
                <button 
                  onClick={handleAddToFavorites}
                  className="bg-gray-300 hover:bg-gray-400 text-gray-800 px-6 py-3 rounded-lg font-semibold"
                >
                  –î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

export default MovieDetailPage;
</file>

<file path="frontend/src/pages/MoviesPage.tsx">
import React, { useState, useEffect } from 'react';
import { Link } from 'react-router-dom';
import { movieService, type Movie } from '../services/movieService';
import { paymentService } from '../services/paymentService';
import { authService } from '../services/authService';

const MoviesPage: React.FC = () => {
  const [movies, setMovies] = useState<Movie[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  const handleBuyTicket = async (movie: Movie) => {
    if (!authService.isAuthenticated()) {
      alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É');
      return;
    }

    try {
      const user = authService.getCurrentUser();
      await paymentService.createPayment({
        userId: user?.id || 0,
        amount: movie.rating || 100,
        currency: 'RUB',
        description: `–ë–∏–ª–µ—Ç –Ω–∞ —Ñ–∏–ª—å–º: ${movie.title}`,
        cardData: {
          cardNumber: '4242424242424242',
          cvv: '123',
          expiryMonth: '12',
          expiryYear: '25'
        }
      });
      alert('–ë–∏–ª–µ—Ç —É—Å–ø–µ—à–Ω–æ –∫—É–ø–ª–µ–Ω!');
    } catch (e) {
      alert('–û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏ –±–∏–ª–µ—Ç–∞: ' + (e as Error).message);
    }
  };

  useEffect(() => {
    const fetchMovies = async () => {
      try {
        setLoading(true);
        const response = await movieService.getMovies();
        setMovies(response.data);
        setError(null);
      } catch (err) {
        setError('Failed to fetch movies');
        console.error('Error fetching movies:', err);
      } finally {
        setLoading(false);
      }
    };

    fetchMovies();
  }, []);

  if (loading) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="text-center">
          <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"></div>
          <p className="text-gray-600">–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∏–ª—å–º–æ–≤...</p>
        </div>
      </div>
    );
  }

  if (error) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="text-center">
          <div className="text-red-600 text-xl mb-4">‚ö†Ô∏è –û—à–∏–±–∫–∞</div>
          <p className="text-gray-600">{error}</p>
          <button 
            onClick={() => window.location.reload()}
            className="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg"
          >
            –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞
          </button>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gray-50 py-8">
      <div className="container mx-auto px-4">
        <div className="text-center mb-8">
          <h1 className="text-4xl font-bold text-gray-900 mb-4">üé¨ –§–∏–ª—å–º—ã</h1>
          <p className="text-gray-600 text-lg">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∏–ª—å–º –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞</p>
        </div>

        {movies.length === 0 ? (
          <div className="text-center py-12">
            <div className="text-gray-500 text-xl mb-4">üìΩ –§–∏–ª—å–º–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>
            <p className="text-gray-400">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ–∑–∂–µ</p>
          </div>
        ) : (
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            {movies.map((movie) => (
              <div key={movie.id} className="bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-200">
                <div className="relative">
                  <img 
                    src={movie.poster_url} 
                    alt={movie.title}
                    className="w-full h-64 object-cover"
                    onError={(e) => {
                      const target = e.target as HTMLImageElement;
                      target.src = 'https://via.placeholder.com/300x450?text=' + movie.title;
                    }}
                  />
                  <div className="p-4">
                    <h3 className="font-bold text-lg mb-2 text-gray-900">{movie.title}</h3>
                    <p className="text-gray-600 text-sm mb-4 line-clamp-3">{movie.description}</p>
                    <div className="flex justify-between items-center mb-4">
                      <div className="flex items-center space-x-4">
                        <span className="text-2xl font-bold text-red-600">‚ÇΩ{movie.rating}</span>
                        <span className="text-sm text-gray-500">/10</span>
                      </div>
                      <div className="flex items-center space-x-2">
                        <span className="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded">
                          {movie.genre}
                        </span>
                        <span className="text-gray-500 text-sm">
                          {movie.release_year}
                        </span>
                        <span className="text-gray-500 text-sm">
                          {movie.duration} –º–∏–Ω
                        </span>
                      </div>
                    </div>
                    <div className="flex justify-between items-center">
                      <Link 
                        to={`/movies/${movie.id}`}
                        className="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-colors duration-200"
                      >
                        –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                      </Link>
                      <button 
                        onClick={() => handleBuyTicket(movie)}
                        className="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-colors duration-200"
                      >
                        –ö—É–ø–∏—Ç—å –±–∏–ª–µ—Ç
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            ))}
          </div>
        )}
      </div>
    </div>
  );
};

export default MoviesPage;
</file>

<file path="frontend/src/services/api.ts">
// API Configuration
export const API_BASE_URL = import.meta.env.VITE_API_URL || 'http://localhost:8080';

// API Endpoints
export const API_ENDPOINTS = {
  // Auth endpoints
  AUTH: {
    LOGIN: `${API_BASE_URL}/api/auth/login`,
    REGISTER: `${API_BASE_URL}/api/auth/register`,
    PROFILE: `${API_BASE_URL}/api/auth/profile`,
    HEALTH: `${API_BASE_URL}/api/auth/health`
  },
  
  // Movies endpoints
  MOVIES: {
    LIST: `${API_BASE_URL}/api/movies`,
    BY_ID: (id: string) => `${API_BASE_URL}/api/movies/${id}`,
    SEARCH: (query: string) => `${API_BASE_URL}/api/movies/search/query?q=${query}`,
    GENRES: `${API_BASE_URL}/api/movies/genres/list`,
    POPULAR: `${API_BASE_URL}/api/movies/popular`,
    HEALTH: `${API_BASE_URL}/api/movies/health`
  },
  
  // Payment endpoints
  PAYMENT: {
    VALIDATE_CARD: `${API_BASE_URL}/api/payment/validate-card`,
    CREATE: `${API_BASE_URL}/api/payment/create`,
    STATUS: (transactionId: string) => `${API_BASE_URL}/api/payment/status/${transactionId}`,
    HISTORY: (userId: string) => `${API_BASE_URL}/api/payment/history/${userId}`,
    REFUND: `${API_BASE_URL}/api/payment/refund`,
    STATS: `${API_BASE_URL}/api/payment/stats`,
    HEALTH: `${API_BASE_URL}/api/payment/health`
  },
  
  // Gateway endpoints
  GATEWAY: {
    HEALTH: `${API_BASE_URL}/health`,
    SERVICES: `${API_BASE_URL}/services`,
    DOCS: `${API_BASE_URL}/api-docs`
  }
};

// Default headers
export const DEFAULT_HEADERS = {
  'Content-Type': 'application/json',
  'Accept': 'application/json'
};

// Helper function to get auth headers
export const getAuthHeaders = () => {
  const token = localStorage.getItem('token');
  return {
    ...DEFAULT_HEADERS,
    'Authorization': `Bearer ${token}`
  };
};

// API response types
export interface ApiResponse<T = any> {
  success: boolean;
  data?: T;
  error?: string;
  message?: string;
}

export interface PaginatedResponse<T> {
  data: T[];
  pagination: {
    page: number;
    limit: number;
    total: number;
    pages: number;
  };
}
</file>

<file path="frontend/src/services/paymentService.ts">
import { API_ENDPOINTS, getAuthHeaders } from './api';

// Types
export interface CardData {
  cardNumber: string;
  cvv: string;
  expiryMonth: string;
  expiryYear: string;
  cardholderName?: string;
}

export interface PaymentRequest {
  userId: number;
  amount: number;
  currency?: string;
  cardData: CardData;
  description?: string;
}

export interface Payment {
  transactionId: string;
  status: 'pending' | 'completed' | 'failed' | 'refunded';
  amount: number;
  currency: string;
  cardLastFour: string;
  description: string;
  createdAt: string;
  updatedAt: string;
}

export interface PaymentHistoryParams {
  page?: number;
  limit?: number;
  status?: 'pending' | 'completed' | 'failed' | 'refunded';
}

export interface RefundRequest {
  transactionId: string;
  reason?: string;
}

export interface PaymentStats {
  totalTransactions: number;
  totalRevenue: number;
  pendingTransactions: number;
  failedTransactions: number;
  averageTransactionAmount: number;
}

// Payment Service
export const paymentService = {
  // Validate card
  async validateCard(cardData: CardData): Promise<any> {
    try {
      const response = await fetch(API_ENDPOINTS.PAYMENT.VALIDATE_CARD, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(cardData),
      });

      const data = await response.json();

      if (!response.ok) {
        throw new Error(data.error || 'Card validation failed');
      }

      return data;
    } catch (error) {
      console.error('Error validating card:', error);
      throw error;
    }
  },

  // Create payment
  async createPayment(paymentData: PaymentRequest): Promise<Payment> {
    try {
      const response = await fetch(API_ENDPOINTS.PAYMENT.CREATE, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          userId: paymentData.userId,
          amount: paymentData.amount,
          currency: paymentData.currency || 'USD',
          cardNumber: paymentData.cardData.cardNumber,
          cvv: paymentData.cardData.cvv,
          expiryMonth: paymentData.cardData.expiryMonth,
          expiryYear: paymentData.cardData.expiryYear,
          description: paymentData.description,
        }),
      });

      const data = await response.json();

      if (!response.ok) {
        throw new Error(data.error || 'Payment creation failed');
      }

      return data;
    } catch (error) {
      console.error('Error creating payment:', error);
      throw error;
    }
  },

  // Get payment status
  async getPaymentStatus(transactionId: string): Promise<Payment> {
    try {
      const response = await fetch(API_ENDPOINTS.PAYMENT.STATUS(transactionId), {
        headers: getAuthHeaders(),
      });

      const data = await response.json();

      if (!response.ok) {
        throw new Error(data.error || 'Failed to get payment status');
      }

      return data;
    } catch (error) {
      console.error('Error getting payment status:', error);
      throw error;
    }
  },

  // Get payment history
  async getPaymentHistory(userId: string, params: PaymentHistoryParams = {}): Promise<any> {
    try {
      const searchParams = new URLSearchParams();
      
      if (params.page) searchParams.append('page', params.page.toString());
      if (params.limit) searchParams.append('limit', params.limit.toString());
      if (params.status) searchParams.append('status', params.status);

      const url = `${API_ENDPOINTS.PAYMENT.HISTORY(userId)}?${searchParams.toString()}`;

      const response = await fetch(url, {
        headers: getAuthHeaders(),
      });

      const data = await response.json();

      if (!response.ok) {
        throw new Error(data.error || 'Failed to get payment history');
      }

      return data;
    } catch (error) {
      console.error('Error getting payment history:', error);
      throw error;
    }
  },

  // Refund payment
  async refundPayment(refundData: RefundRequest): Promise<any> {
    try {
      const response = await fetch(API_ENDPOINTS.PAYMENT.REFUND, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(refundData),
      });

      const data = await response.json();

      if (!response.ok) {
        throw new Error(data.error || 'Refund failed');
      }

      return data;
    } catch (error) {
      console.error('Error refunding payment:', error);
      throw error;
    }
  },

  // Get payment statistics
  async getPaymentStats(params?: { startDate?: string; endDate?: string }): Promise<PaymentStats> {
    try {
      const searchParams = new URLSearchParams();
      
      if (params?.startDate) searchParams.append('startDate', params.startDate);
      if (params?.endDate) searchParams.append('endDate', params.endDate);

      const url = `${API_ENDPOINTS.PAYMENT.STATS}?${searchParams.toString()}`;

      const response = await fetch(url, {
        headers: getAuthHeaders(),
      });

      const data = await response.json();

      if (!response.ok) {
        throw new Error(data.error || 'Failed to get payment stats');
      }

      return data.statistics || data;
    } catch (error) {
      console.error('Error getting payment stats:', error);
      throw error;
    }
  },

  // Check payment service health
  async checkHealth(): Promise<any> {
    try {
      const response = await fetch(API_ENDPOINTS.PAYMENT.HEALTH);
      return await response.json();
    } catch (error) {
      console.error('Payment service health check failed:', error);
      return null;
    }
  },
};

export default paymentService;
</file>

<file path="frontend/tsconfig.app.json">
{
  "compilerOptions": {
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.app.tsbuildinfo",
    "target": "ES2022",
    "useDefineForClassFields": true,
    "lib": ["ES2022", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "types": ["vite/client"],
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "verbatimModuleSyntax": true,
    "moduleDetection": "force",
    "noEmit": true,
    "jsx": "react-jsx",

    /* Linting */
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "erasableSyntaxOnly": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["src"]
}
</file>

<file path="frontend/tsconfig.node.json">
{
  "compilerOptions": {
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.node.tsbuildinfo",
    "target": "ES2023",
    "lib": ["ES2023"],
    "module": "ESNext",
    "types": ["node"],
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "verbatimModuleSyntax": true,
    "moduleDetection": "force",
    "noEmit": true,

    /* Linting */
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "erasableSyntaxOnly": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["vite.config.ts"]
}
</file>

<file path="frontend/vite.config.ts">
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

// https://vite.dev/config/
export default defineConfig({
  plugins: [react()],
})
</file>

<file path="nginx/nginx.conf">
events {
    worker_connections 1024;
}

http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    # Log format
    log_format main '$remote_addr - $remote_user [$time_local] "$request" '
                    '$status $body_bytes_sent "$http_referer" '
                    '"$http_user_agent" "$http_x_forwarded_for"';

    access_log /var/log/nginx/access.log main;
    error_log /var/log/nginx/error.log warn;

    # Basic settings
    sendfile on;
    tcp_nopush on;
    tcp_nodelay on;
    keepalive_timeout 65;
    types_hash_max_size 2048;
    client_max_body_size 10M;

    # Gzip compression
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_proxied any;
    gzip_comp_level 6;
    gzip_types
        text/plain
        text/css
        text/xml
        text/javascript
        application/json
        application/javascript
        application/xml+rss
        application/atom+xml
        image/svg+xml;

    # Upstream servers
    upstream api_gateway {
        server api-gateway:8080;
    }

    # Main server block
    server {
        listen 80;
        server_name localhost;

        # Security headers
        add_header X-Frame-Options "SAMEORIGIN" always;
        add_header X-XSS-Protection "1; mode=block" always;
        add_header X-Content-Type-Options "nosniff" always;
        add_header Referrer-Policy "no-referrer-when-downgrade" always;
        add_header Content-Security-Policy "default-src 'self' http: https: data: blob: 'unsafe-inline'" always;

        # Frontend static files
        location / {
            root /usr/share/nginx/html;
            index index.html index.htm;
            try_files $uri $uri/ /index.html;
            
            # Cache static assets
            location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
                expires 1y;
                add_header Cache-Control "public, immutable";
            }
            
            # Cache HTML files
            location ~* \.html$ {
                expires 1h;
                add_header Cache-Control "public";
            }
        }

        # API Gateway proxy
        location /api/ {
            proxy_pass http://api_gateway;
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection 'upgrade';
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_cache_bypass $http_upgrade;
            
            # Timeout settings
            proxy_connect_timeout 60s;
            proxy_send_timeout 60s;
            proxy_read_timeout 60s;
            
            # Buffer settings
            proxy_buffering on;
            proxy_buffer_size 4k;
            proxy_buffers 8 4k;
            proxy_busy_buffers_size 8k;
        }

        # API Documentation
        location /api-docs {
            proxy_pass http://api_gateway;
            proxy_http_version 1.1;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
        }

        # Health check
        location /health {
            proxy_pass http://api_gateway;
            proxy_http_version 1.1;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
        }

        # Error pages
        error_page 404 /index.html;
        error_page 500 502 503 504 /50x.html;
        location = /50x.html {
            root /usr/share/nginx/html;
        }
    }

    # HTTPS server (optional - for production)
    # server {
    #     listen 443 ssl http2;
    #     server_name localhost;
    #     
    #     ssl_certificate /etc/nginx/ssl/cert.pem;
    #     ssl_certificate_key /etc/nginx/ssl/key.pem;
    #     
    #     ssl_protocols TLSv1.2 TLSv1.3;
    #     ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384;
    #     ssl_prefer_server_ciphers off;
    #     
    #     # Same configuration as HTTP
    #     include /etc/nginx/conf.d/common.conf;
    # }
}
</file>

<file path="package.json">
{
  "devDependencies": {
    "concurrently": "^9.2.1"
  },
  "scripts": {
    "start:all": "concurrently \"npm run dev --prefix backend/api-gateway\" \"npm run dev --prefix backend/auth-service\" \"npm run dev --prefix backend/movies-service\" \"npm run dev --prefix backend/payment-service\"",
    "dev": "concurrently \"npm run dev --prefix backend/api-gateway\" \"npm run dev --prefix backend/auth-service\" \"npm run dev --prefix backend/movies-service\" \"npm run dev --prefix backend/payment-service\""
  }
}
</file>

<file path="README.md">
# CineScope - –ö–∏–Ω–æ—Ç–µ–∞—Ç—Ä–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –æ–Ω–ª–∞–π–Ω-–∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä–∞ —Å —Ñ—É–Ω–∫—Ü–∏–µ–π –ø–æ–∫—É–ø–∫–∏ –±–∏–ª–µ—Ç–æ–≤.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
cinescope-clone/
‚îú‚îÄ‚îÄ frontend/          # React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ backend/           # –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ auth-service/     # –°–µ—Ä–≤–∏—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ movies-service/   # –°–µ—Ä–≤–∏—Å —Ñ–∏–ª—å–º–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ payment-api/      # –®–ª—é–∑ –æ–ø–ª–∞—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ payment-checker/  # –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–∞—Ä—Ç
‚îÇ   ‚îî‚îÄ‚îÄ payment-registry/ # –†–µ–µ—Å—Ç—Ä –ø–ª–∞—Ç–µ–∂–µ–π
‚îú‚îÄ‚îÄ docker/            # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ scripts/           # –°–∫—Ä–∏–ø—Ç—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
‚îî‚îÄ‚îÄ docs/              # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Frontend**: React, TypeScript, TailwindCSS
- **Backend**: Node.js, Express, TypeScript
- **–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL, MongoDB
- **–ë—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π**: Apache Kafka
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è**: Docker, Kubernetes
- **CI/CD**: Jenkins
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: Kibana

## –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã

1. **Auth Service** - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. **Movies Service** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–æ–º —Ñ–∏–ª—å–º–æ–≤
3. **Payment API** - —à–ª—é–∑ –¥–ª—è –ø—Ä–∏–µ–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π
4. **Payment Card Checker** - –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö –∫–∞—Ä—Ç
5. **Payment Registry** - —Ä–µ–µ—Å—Ç—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d

# –ó–∞–ø—É—Å–∫ frontend
cd frontend && npm start

# –ó–∞–ø—É—Å–∫ –±—ç–∫–µ–Ω–¥–∞
cd backend && docker-compose up
```

## –°—Ä–µ–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

- **Dev**: dev.cinescope.store
- **Prod**: prod.cinescope.store
</file>

<file path="backend/api-gateway/.env.example">
# API Gateway Configuration
PORT=8080
NODE_ENV=development

# Microservices URLs
AUTH_SERVICE_URL=http://localhost:3001
MOVIES_SERVICE_URL=http://localhost:3002
PAYMENT_SERVICE_URL=http://localhost:3003

# Frontend Configuration
FRONTEND_URL=http://localhost:5173
FRONTEND_BUILD_PATH=../../frontend-vite/dist

# CORS Configuration
ALLOWED_ORIGINS=http://localhost:5173,http://localhost:3000,http://localhost:8080

# Swagger Configuration
SWAGGER_ENABLED=true
SWAGGER_PATH=/api-docs
</file>

<file path="backend/api-gateway/src/routes/gateway.js">
import express from 'express';
import path from 'path';
import { fileURLToPath } from 'url';
import { dirname } from 'path';

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

const router = express.Router();

/**
 * @swagger
 * tags:
 *   name: Gateway
 *   description: API Gateway operations
 */

/**
 * @swagger
 * /health:
 *   get:
 *     tags: [Gateway]
 *     summary: Get API Gateway health status
 *     description: Returns the health status of the API Gateway and all microservices
 *     responses:
 *       200:
 *         description: Gateway and services are healthy
 *         content:
 *           application/json:
 *             schema:
 *               type: object
 *               properties:
 *                 status:
 *                   type: string
 *                   example: OK
 *                 service:
 *                   type: string
 *                   example: api-gateway
 *                 timestamp:
 *                   type: string
 *                   format: date-time
 *                 version:
 *                   type: string
 *                   example: 1.0.0
 *                 services:
 *                   type: array
 *                   items:
 *                     type: object
 *                     properties:
 *                       name:
 *                         type: string
 *                       url:
 *                         type: string
 *                       status:
 *                         type: string
 *                         enum: [healthy, unhealthy, unknown]
 *       503:
 *         description: One or more services are unhealthy
 */
router.get('/health', (req, res) => {
  res.json({
    status: 'OK',
    service: 'api-gateway',
    timestamp: new Date().toISOString(),
    version: '1.0.0',
    uptime: process.uptime(),
    services: req.servicesHealth || []
  });
});

/**
 * @swagger
 * /:
 *   get:
 *     tags: [Gateway]
 *     summary: Get API Gateway information
 *     description: Returns information about the API Gateway and available services
 *     responses:
 *       200:
 *         description: Gateway information
 *         content:
 *           application/json:
 *             schema:
 *               type: object
 *               properties:
 *                 message:
 *                   type: string
 *                   example: üö™ CineScope API Gateway
 *                 version:
 *                   type: string
 *                   example: 1.0.0
 *                 description:
 *                   type: string
 *                   example: Central gateway for all CineScope microservices
 *                 services:
 *                   type: array
 *                   items:
 *                     type: object
 *                     properties:
 *                       name:
 *                         type: string
 *                       endpoint:
 *                         type: string
 *                       description:
 *                         type: string
 *                 documentation:
 *                   type: string
 *                   example: /api-docs
 */
router.get('/', (req, res) => {
  res.json({
    message: 'üö™ CineScope API Gateway',
    version: '1.0.0',
    description: 'Central gateway for all CineScope microservices',
    services: [
      {
        name: 'Authentication Service',
        endpoint: '/api/auth/*',
        description: 'User authentication and authorization'
      },
      {
        name: 'Movies Service',
        endpoint: '/api/movies/*',
        description: 'Movie catalog and search'
      },
      {
        name: 'Payment Service',
        endpoint: '/api/payment/*',
        description: 'Payment processing and validation'
      }
    ],
    documentation: '/api-docs',
    health: '/health',
    timestamp: new Date().toISOString()
  });
});

/**
 * @swagger
 * /services:
 *   get:
 *     tags: [Gateway]
 *     summary: Get available services status
 *     description: Returns the status of all available microservices
 *     responses:
 *       200:
 *         description: Services status
 */
router.get('/services', (req, res) => {
  res.json({
    services: req.servicesHealth || [],
    total: req.servicesHealth ? req.servicesHealth.length : 0,
    healthy: req.servicesHealth ? req.servicesHealth.filter(s => s.status === 'healthy').length : 0,
    unhealthy: req.servicesHealth ? req.servicesHealth.filter(s => s.status === 'unhealthy').length : 0,
    timestamp: new Date().toISOString()
  });
});

/**
 * @swagger
 * /routes:
 *   get:
 *     tags: [Gateway]
 *     summary: Get all available routes
 *     description: Returns all available routes through the gateway
 *     responses:
 *       200:
 *         description: Available routes
 */
router.get('/routes', (req, res) => {
  res.json({
    routes: [
      {
        method: 'GET',
        path: '/',
        description: 'Gateway information'
      },
      {
        method: 'GET',
        path: '/health',
        description: 'Health check'
      },
      {
        method: 'GET',
        path: '/services',
        description: 'Services status'
      },
      {
        method: 'GET',
        path: '/routes',
        description: 'Available routes'
      },
      {
        method: 'GET',
        path: '/api-docs',
        description: 'Swagger documentation'
      },
      {
        method: 'ALL',
        path: '/api/auth/*',
        description: 'Authentication Service'
      },
      {
        method: 'ALL',
        path: '/api/movies/*',
        description: 'Movies Service'
      },
      {
        method: 'ALL',
        path: '/api/payment/*',
        description: 'Payment Service'
      }
    ],
    timestamp: new Date().toISOString()
  });
});

// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–µ—Å–ª–∏ —Å–æ–±—Ä–∞–Ω—ã)
router.use(express.static(path.join(__dirname, '../../../frontend/dist'), {
  fallthrough: true, // –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É
  maxAge: '1d', // –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ 1 –¥–µ–Ω—å
  etag: true
}));

// Fallback –¥–ª—è React Router (SPA)
router.use((req, res, next) => {
  // –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å /api/, —ç—Ç–æ API –∑–∞–ø—Ä–æ—Å
  if (req.path.startsWith('/api/')) {
    return next();
  }
  
  // –î–ª—è –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç–¥–∞–µ–º index.html
  const indexPath = path.join(__dirname, '../../../frontend/dist/index.html');
  res.sendFile(indexPath, (err) => {
    if (err) {
      console.error('Error serving index.html:', err);
      res.status(500).json({
        error: 'Frontend not available',
        message: 'Frontend build not found. Please build the frontend application.'
      });
    }
  });
});

export default router;
</file>

<file path="backend/auth-service/src/database.js">
const sqlite3 = require('sqlite3');
const path = require('path');

const dbPath = path.join(process.cwd(), 'database.sqlite');

const db = new sqlite3.Database(dbPath, (err) => {
  if (err) {
    console.error('Error opening database:', err.message);
  } else {
    console.log('‚úÖ Connected to SQLite database');
    createTables();
  }
});

function createTables() {
  // –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  db.run(`
    CREATE TABLE IF NOT EXISTS users (
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      email TEXT UNIQUE NOT NULL,
      password_hash TEXT NOT NULL,
      created_at DATETIME DEFAULT CURRENT_TIMESTAMP
    )
  `, (err) => {
    if (err) {
      console.error('Error creating users table:', err.message);
    } else {
      console.log('‚úÖ Users table created or already exists');
    }
  });
}

module.exports = db;
</file>

<file path="backend/auth-service/src/index.js">
const express = require('express');
const cors = require('cors');
const helmet = require('helmet');
const morgan = require('morgan');
require('dotenv').config();

const authRoutes = require('./routes/auth.js');
const db = require('./database.js');

const app = express();
const PORT = process.env.PORT || 3001;

// Middleware
app.use(helmet());
app.use(cors());
app.use(morgan('combined'));
app.use(express.json());

// Routes
app.use('/auth', authRoutes);

app.get('/health', (req, res) => {
  res.json({ 
    status: 'OK', 
    service: 'auth-service',
    timestamp: new Date().toISOString()
  });
});

// Start server
app.listen(PORT, () => {
  console.log(`üöÄ Auth Service running on port ${PORT}`);
  console.log(`üìä Health check: http://localhost:${PORT}/health`);
  console.log(`üîê Auth endpoints: http://localhost:${PORT}/auth`);
});

module.exports = app;
</file>

<file path="backend/auth-service/src/routes/auth.js">
const express = require('express');
const bcrypt = require('bcryptjs');
const jwt = require('jsonwebtoken');
const db = require('../database.js');

const router = express.Router();

// –ü–æ–ª—É—á–∞–µ–º —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
const JWT_SECRET = process.env.JWT_SECRET || 'fallback-secret-key';
const JWT_EXPIRES_IN = process.env.JWT_EXPIRES_IN || '24h';

// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
router.post('/register', async (req, res) => {
  const { email, password } = req.body;

  if (!email || !password) {
    return res.status(400).json({ error: 'Email and password are required' });
  }

  try {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    db.get('SELECT id FROM users WHERE email = ?', [email], async (err, row) => {
      if (err) {
        return res.status(500).json({ error: 'Database error' });
      }

      if (row) {
        return res.status(400).json({ error: 'User already exists' });
      }

      // –•–µ—à–∏—Ä—É–µ–º –ø–∞—Ä–æ–ª—å
      const hashedPassword = await bcrypt.hash(password, 10);

      // –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      db.run(
        'INSERT INTO users (email, password_hash) VALUES (?, ?)',
        [email, hashedPassword],
        function(err) {
          if (err) {
            return res.status(500).json({ error: 'Database error' });
          }

          res.status(201).json({ 
            message: 'User created successfully',
            userId: this.lastID 
          });
        }
      );
    });
  } catch (error) {
    res.status(500).json({ error: 'Server error' });
  }
});

// –í—Ö–æ–¥
router.post('/login', async (req, res) => {
  const { email, password } = req.body;

  if (!email || !password) {
    return res.status(400).json({ error: 'Email and password are required' });
  }

  try {
    db.get('SELECT * FROM users WHERE email = ?', [email], async (err, row) => {
      if (err) {
        return res.status(500).json({ error: 'Database error' });
      }

      if (!row) {
        return res.status(401).json({ error: 'Invalid credentials' });
      }

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ä–æ–ª—å
      const isValidPassword = await bcrypt.compare(password, row.password_hash);
      if (!isValidPassword) {
        return res.status(401).json({ error: 'Invalid credentials' });
      }

      // –°–æ–∑–¥–∞–µ–º JWT —Ç–æ–∫–µ–Ω - –ü–†–û–°–¢–û–ô –í–ê–†–ò–ê–ù–¢
      const payload = { userId: row.id, email: row.email };
      const token = jwt.sign(payload, JWT_SECRET, { expiresIn: JWT_EXPIRES_IN });

      res.json({
        message: 'Login successful',
        token,
        user: {
          id: row.id,
          email: row.email
        }
      });
    });
  } catch (error) {
    res.status(500).json({ error: 'Server error' });
  }
});

// Middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞
function authenticateToken(req, res, next) {
  const token = req.headers.authorization?.replace('Bearer ', '');

  if (!token) {
    return res.status(401).json({ error: 'Token is required' });
  }

  try {
    const decoded = jwt.verify(token, JWT_SECRET);
    req.user = decoded;
    next();
  } catch (error) {
    return res.status(401).json({ error: 'Invalid token' });
  }
}

// –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
router.get('/profile', authenticateToken, async (req, res) => {
  try {
    db.get('SELECT id, email, created_at FROM users WHERE id = ?', [req.user.userId], (err, row) => {
      if (err) {
        return res.status(500).json({ error: 'Database error' });
      }

      if (!row) {
        return res.status(404).json({ error: 'User not found' });
      }

      res.json({ user: row });
    });
  } catch (error) {
    return res.status(401).json({ error: 'Invalid token' });
  }
});

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∞–ª–∏–∞—Å –¥–ª—è /profile)
router.get('/me', authenticateToken, async (req, res) => {
  try {
    db.get('SELECT id, email, created_at FROM users WHERE id = ?', [req.user.userId], (err, row) => {
      if (err) {
        return res.status(500).json({ error: 'Database error' });
      }

      if (!row) {
        return res.status(404).json({ error: 'User not found' });
      }

      res.json({ user: row });
    });
  } catch (error) {
    return res.status(401).json({ error: 'Invalid token' });
  }
});

module.exports = router;
</file>

<file path="backend/movies-service/src/index.js">
import express from 'express';
import cors from 'cors';
import helmet from 'helmet';
import morgan from 'morgan';
import dotenv from 'dotenv';
import moviesRoutes from './routes/movies.js';

// –ó–∞–≥—Ä—É–∂–∞–µ–º .env –ü–ï–†–ï–î –≤—Å–µ–º–∏ –∏–º–ø–æ—Ä—Ç–∞–º–∏
dotenv.config();

import './database.js'; // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

const app = express();
const PORT = process.env.PORT || 3002;

// Middleware
app.use(helmet());
app.use(cors({
  origin: process.env.FRONTEND_URL || 'http://localhost:5173',
  credentials: true
}));
app.use(morgan('combined'));
app.use(express.json());

// Health check (–î–û routes!)
app.get('/health', (req, res) => {
  res.json({ 
    status: 'OK', 
    service: 'movies-service',
    timestamp: new Date().toISOString(),
    version: '1.0.0'
  });
});

// Routes
app.use('/', moviesRoutes);

// Root endpoint
app.get('/', (req, res) => {
  res.json({
    message: 'üé¨ Movies Service API',
    version: '1.0.0',
    endpoints: {
      health: '/health',
      movies: '/movies',
      movieById: '/movies/:id',
      search: '/movies/search/query?q=...',
      genres: '/movies/genres/list',
      popular: '/movies/popular'
    }
  });
});

// Error handling middleware
app.use((err, req, res, next) => {
  console.error(err.stack);
  res.status(500).json({ 
    error: 'Something went wrong!',
    message: process.env.NODE_ENV === 'development' ? err.message : undefined
  });
});

// 404 handler
app.use((req, res) => {
  res.status(404).json({ 
    error: 'Not Found',
    message: `Route ${req.originalUrl} not found` 
  });
});

// Start server
app.listen(PORT, () => {
  console.log(`üé¨ Movies Service running on port ${PORT}`);
  console.log(`üìä Health check: http://localhost:${PORT}/health`);
  console.log(`üé• Movies API: http://localhost:${PORT}/movies`);
  console.log(`üîç Search: http://localhost:${PORT}/movies/search/query?q=inception`);
});

export default app;
</file>

<file path="backend/payment-service/package.json">
{
  "name": "payment-service",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "start": "node src/index.js",
    "dev": "nodemon src/index.js",
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "type": "module",
  "dependencies": {
    "cors": "^2.8.6",
    "dotenv": "^17.3.1",
    "express": "^5.2.1",
    "helmet": "^8.1.0",
    "morgan": "^1.10.1",
    "sqlite3": "^5.1.7"
  },
  "devDependencies": {
    "nodemon": "^3.1.11"
  }
}
</file>

<file path="frontend/.gitignore">
# Logs
logs
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*
pnpm-debug.log*
lerna-debug.log*

node_modules
dist
dist-ssr
*.local

# Editor directories and files
.vscode/*
!.vscode/extensions.json
.idea
.DS_Store
*.suo
*.ntvs*
*.njsproj
*.sln
*.sw?
</file>

<file path="frontend/postcss.config.js">
export default {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
}
</file>

<file path="frontend/README.md">
# React + TypeScript + Vite

This template provides a minimal setup to get React working in Vite with HMR and some ESLint rules.

Currently, two official plugins are available:

- [@vitejs/plugin-react](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react) uses [Babel](https://babeljs.io/) (or [oxc](https://oxc.rs) when used in [rolldown-vite](https://vite.dev/guide/rolldown)) for Fast Refresh
- [@vitejs/plugin-react-swc](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react-swc) uses [SWC](https://swc.rs/) for Fast Refresh

## React Compiler

The React Compiler is not enabled on this template because of its impact on dev & build performances. To add it, see [this documentation](https://react.dev/learn/react-compiler/installation).

## Expanding the ESLint configuration

If you are developing a production application, we recommend updating the configuration to enable type-aware lint rules:

```js
export default defineConfig([
  globalIgnores(['dist']),
  {
    files: ['**/*.{ts,tsx}'],
    extends: [
      // Other configs...

      // Remove tseslint.configs.recommended and replace with this
      tseslint.configs.recommendedTypeChecked,
      // Alternatively, use this for stricter rules
      tseslint.configs.strictTypeChecked,
      // Optionally, add this for stylistic rules
      tseslint.configs.stylisticTypeChecked,

      // Other configs...
    ],
    languageOptions: {
      parserOptions: {
        project: ['./tsconfig.node.json', './tsconfig.app.json'],
        tsconfigRootDir: import.meta.dirname,
      },
      // other options...
    },
  },
])
```

You can also install [eslint-plugin-react-x](https://github.com/Rel1cx/eslint-react/tree/main/packages/plugins/eslint-plugin-react-x) and [eslint-plugin-react-dom](https://github.com/Rel1cx/eslint-react/tree/main/packages/plugins/eslint-plugin-react-dom) for React-specific lint rules:

```js
// eslint.config.js
import reactX from 'eslint-plugin-react-x'
import reactDom from 'eslint-plugin-react-dom'

export default defineConfig([
  globalIgnores(['dist']),
  {
    files: ['**/*.{ts,tsx}'],
    extends: [
      // Other configs...
      // Enable lint rules for React
      reactX.configs['recommended-typescript'],
      // Enable lint rules for React DOM
      reactDom.configs.recommended,
    ],
    languageOptions: {
      parserOptions: {
        project: ['./tsconfig.node.json', './tsconfig.app.json'],
        tsconfigRootDir: import.meta.dirname,
      },
      // other options...
    },
  },
])
```
</file>

<file path="frontend/src/App.css">
#root {
  max-width: 1280px;
  margin: 0 auto;
  padding: 2rem;
  text-align: center;
}

.logo {
  height: 6em;
  padding: 1.5em;
  will-change: filter;
  transition: filter 300ms;
}
.logo:hover {
  filter: drop-shadow(0 0 2em #646cffaa);
}
.logo.react:hover {
  filter: drop-shadow(0 0 2em #61dafbaa);
}

@keyframes logo-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@media (prefers-reduced-motion: no-preference) {
  a:nth-of-type(2) .logo {
    animation: logo-spin infinite 20s linear;
  }
}

.card {
  padding: 2em;
}

.read-the-docs {
  color: #888;
}
</file>

<file path="frontend/src/index.css">
@tailwind base;
@tailwind components;
@tailwind utilities;

body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
</file>

<file path="frontend/src/services/authService.ts">
import { API_ENDPOINTS, getAuthHeaders, type ApiResponse } from './api';

// Types
export interface LoginRequest {
  email: string;
  password: string;
}

export interface RegisterRequest {
  email: string;
  password: string;
  name?: string;
}

export interface User {
  id: number;
  email: string;
  name?: string;
  created_at: string;
}

export interface AuthResponse {
  user: User;
  token: string;
  expiresIn: string;
}

// Auth Service
export const authService = {
  // Login user
  async login(credentials: LoginRequest): Promise<ApiResponse<AuthResponse>> {
    try {
      const response = await fetch(API_ENDPOINTS.AUTH.LOGIN, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(credentials),
      });

      const data = await response.json();

      if (!response.ok) {
        return {
          success: false,
          error: data.error || 'Login failed',
        };
      }

      // Save token to localStorage
      if (data.token) {
        localStorage.setItem('token', data.token);
        localStorage.setItem('user', JSON.stringify(data.user));
      }

      return {
        success: true,
        data: data,
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : 'Network error',
      };
    }
  },

  // Register user
  async register(userData: RegisterRequest): Promise<ApiResponse<AuthResponse>> {
    try {
      const response = await fetch(API_ENDPOINTS.AUTH.REGISTER, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(userData),
      });

      const data = await response.json();

      if (!response.ok) {
        return {
          success: false,
          error: data.error || 'Registration failed',
        };
      }

      // Save token to localStorage
      if (data.token) {
        localStorage.setItem('token', data.token);
        localStorage.setItem('user', JSON.stringify(data.user));
      }

      return {
        success: true,
        data: data,
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : 'Network error',
      };
    }
  },

  // Get user profile
  async getProfile(): Promise<ApiResponse<User>> {
    try {
      const response = await fetch(API_ENDPOINTS.AUTH.PROFILE, {
        headers: getAuthHeaders(),
      });

      const data = await response.json();

      if (!response.ok) {
        return {
          success: false,
          error: data.error || 'Failed to get profile',
        };
      }

      return {
        success: true,
        data: data.user || data,
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : 'Network error',
      };
    }
  },

  // Logout user
  logout(): void {
    localStorage.removeItem('token');
    localStorage.removeItem('user');
  },

  // Check if user is authenticated
  isAuthenticated(): boolean {
    const token = localStorage.getItem('token');
    return !!token;
  },

  // Get current user
  getCurrentUser(): User | null {
    const userStr = localStorage.getItem('user');
    return userStr ? JSON.parse(userStr) : null;
  },

  // Get token
  getToken(): string | null {
    return localStorage.getItem('token');
  },

  // Check auth service health
  async checkHealth(): Promise<ApiResponse<any>> {
    try {
      const response = await fetch(API_ENDPOINTS.AUTH.HEALTH);
      const data = await response.json();

      return {
        success: response.ok,
        data: data,
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : 'Health check failed',
      };
    }
  },
};

export default authService;
</file>

<file path="frontend/src/services/movieService.ts">
import { API_ENDPOINTS, getAuthHeaders, type PaginatedResponse } from './api';

// Types
export interface Movie {
  id: number;
  title: string;
  description: string;
  duration: number;
  rating: number;
  poster_url: string;
  genre: string;
  release_year: number;
  created_at: string;
  updated_at: string;
}

export interface MovieSearchParams {
  page?: number;
  limit?: number;
  genre?: string;
  search?: string;
  sortBy?: 'title' | 'rating' | 'release_year';
  sortOrder?: 'asc' | 'desc';
}

// Movies Service
export const movieService = {
  // Get all movies with pagination
  async getMovies(params: MovieSearchParams = {}): Promise<PaginatedResponse<Movie>> {
    try {
      const searchParams = new URLSearchParams();
      
      if (params.page) searchParams.append('page', params.page.toString());
      if (params.limit) searchParams.append('limit', params.limit.toString());
      if (params.genre) searchParams.append('genre', params.genre);
      if (params.sortBy) searchParams.append('sortBy', params.sortBy);
      if (params.sortOrder) searchParams.append('sortOrder', params.sortOrder);

      const url = params.search 
        ? API_ENDPOINTS.MOVIES.SEARCH(params.search)
        : `${API_ENDPOINTS.MOVIES.LIST}?${searchParams.toString()}`;

      const response = await fetch(url, {
        headers: getAuthHeaders(),
      });

      const data = await response.json();

      if (!response.ok) {
        throw new Error(data.error || 'Failed to fetch movies');
      }

      return {
        data: data.movies || data.data || [],
        pagination: data.pagination || {
          page: params.page || 1,
          limit: params.limit || 10,
          total: data.total || 0,
          pages: Math.ceil((data.total || 0) / (params.limit || 10)),
        },
      };
    } catch (error) {
      console.error('Error fetching movies:', error);
      return {
        data: [],
        pagination: {
          page: 1,
          limit: 10,
          total: 0,
          pages: 0,
        },
      };
    }
  },

  // Get movie by ID
  async getMovieById(id: string): Promise<Movie | null> {
    try {
      const response = await fetch(API_ENDPOINTS.MOVIES.BY_ID(id), {
        headers: getAuthHeaders(),
      });

      const data = await response.json();

      if (!response.ok) {
        throw new Error(data.error || 'Failed to fetch movie');
      }

      return data.movie || data;
    } catch (error) {
      console.error('Error fetching movie:', error);
      return null;
    }
  },

  // Search movies
  async searchMovies(query: string, params: MovieSearchParams = {}): Promise<PaginatedResponse<Movie>> {
    return this.getMovies({ ...params, search: query });
  },

  // Get movies by genre
  async getMoviesByGenre(genre: string, params: MovieSearchParams = {}): Promise<PaginatedResponse<Movie>> {
    return this.getMovies({ ...params, genre });
  },

  // Get popular movies
  async getPopularMovies(params: MovieSearchParams = {}): Promise<PaginatedResponse<Movie>> {
    try {
      const searchParams = new URLSearchParams();
      
      if (params.page) searchParams.append('page', params.page.toString());
      if (params.limit) searchParams.append('limit', params.limit.toString());

      const url = `${API_ENDPOINTS.MOVIES.POPULAR}?${searchParams.toString()}`;

      const response = await fetch(url, {
        headers: getAuthHeaders(),
      });

      const data = await response.json();

      if (!response.ok) {
        throw new Error(data.error || 'Failed to fetch popular movies');
      }

      return {
        data: data.movies || data.data || [],
        pagination: data.pagination || {
          page: params.page || 1,
          limit: params.limit || 10,
          total: data.total || 0,
          pages: Math.ceil((data.total || 0) / (params.limit || 10)),
        },
      };
    } catch (error) {
      console.error('Error fetching popular movies:', error);
      return {
        data: [],
        pagination: {
          page: 1,
          limit: 10,
          total: 0,
          pages: 0,
        },
      };
    }
  },

  // Get all genres
  async getGenres(): Promise<string[]> {
    try {
      const response = await fetch(API_ENDPOINTS.MOVIES.GENRES, {
        headers: getAuthHeaders(),
      });

      const data = await response.json();

      if (!response.ok) {
        throw new Error(data.error || 'Failed to fetch genres');
      }

      return data.genres || [];
    } catch (error) {
      console.error('Error fetching genres:', error);
      return [];
    }
  },

  // Check movies service health
  async checkHealth(): Promise<any> {
    try {
      const response = await fetch(API_ENDPOINTS.MOVIES.HEALTH);
      return await response.json();
    } catch (error) {
      console.error('Movies service health check failed:', error);
      return null;
    }
  },
};

export default movieService;
</file>

<file path="frontend/tailwind.config.js">
/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    "./index.html",
    "./src/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {},
  },
  plugins: [],
}
</file>

<file path="frontend/tsconfig.json">
{
  "files": [],
  "references": [
    { "path": "./tsconfig.app.json" },
    { "path": "./tsconfig.node.json" }
  ]
}
</file>

<file path="backend/api-gateway/src/index.js">
import express from 'express';
import cors from 'cors';
import helmet from 'helmet';
import morgan from 'morgan';
import dotenv from 'dotenv';
import path from 'path';
import { fileURLToPath } from 'url';
import { dirname } from 'path';

// Middleware
import { authProxy, moviesProxy, paymentProxy, healthCheckMiddleware } from './middleware/proxy.js';
import { specs, swaggerMiddleware, swaggerSetup } from './middleware/swagger.js';

// Routes
import gatewayRoutes from './routes/gateway.js';

// –ó–∞–≥—Ä—É–∂–∞–µ–º .env –ü–ï–†–ï–î –≤—Å–µ–º–∏ –∏–º–ø–æ—Ä—Ç–∞–º–∏
dotenv.config();

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

const app = express();
const PORT = process.env.PORT || 8080;

// Middleware
app.use(helmet({
  contentSecurityPolicy: false, // –û—Ç–∫–ª—é—á–∞–µ–º CSP –¥–ª—è Swagger UI
}));

app.use(cors({
  origin: (process.env.ALLOWED_ORIGINS || 'http://localhost:5173').split(','),
  credentials: true,
  methods: ['GET', 'POST', 'PUT', 'DELETE', 'OPTIONS'],
  allowedHeaders: ['Content-Type', 'Authorization', 'X-Requested-With']
}));

app.use(morgan('combined'));
app.use(express.json({ limit: '10mb' }));
app.use(express.urlencoded({ extended: true, limit: '10mb' }));

// Rate limiting middleware (–ø—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
const rateLimit = {};
app.use((req, res, next) => {
  const key = req.ip;
  const now = Date.now();
  const windowMs = 60 * 1000; // 1 –º–∏–Ω—É—Ç–∞
  const maxRequests = 1000; // –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π –ª–∏–º–∏—Ç –¥–ª—è gateway

  if (!rateLimit[key]) {
    rateLimit[key] = { count: 0, resetTime: now + windowMs };
  }

  if (now > rateLimit[key].resetTime) {
    rateLimit[key] = { count: 0, resetTime: now + windowMs };
  }

  rateLimit[key].count++;

  if (rateLimit[key].count > maxRequests) {
    return res.status(429).json({
      error: 'Too many requests',
      message: `Rate limit exceeded. Max ${maxRequests} requests per minute.`,
      retryAfter: Math.ceil((rateLimit[key].resetTime - now) / 1000)
    });
  }

  next();
});

// Request logging middleware
app.use((req, res, next) => {
  const start = Date.now();
  
  res.on('finish', () => {
    const duration = Date.now() - start;
    console.log(`üìù ${req.method} ${req.originalUrl} - ${res.statusCode} - ${duration}ms`);
  });
  
  next();
});

// Static files first (highest priority)
app.use(express.static(path.join(__dirname, '../../../frontend/dist'), {
  fallthrough: true,
  maxAge: '1d',
  etag: true
}));

// API Routes (BEFORE gateway routes!)
app.use('/api/auth', authProxy);
app.use('/api/movies', moviesProxy);
app.use('/api/payment', paymentProxy);

// Gateway routes (API only)
app.use('/health', healthCheckMiddleware, (req, res) => {
  res.json({
    status: 'OK',
    service: 'api-gateway',
    timestamp: new Date().toISOString(),
    version: '1.0.0',
    uptime: process.uptime(),
    services: req.servicesHealth || []
  });
});

// Swagger documentation (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω)
if (process.env.SWAGGER_ENABLED !== 'false') {
  app.use('/api-docs', swaggerMiddleware, swaggerSetup);
  console.log(`üìö Swagger documentation: http://localhost:${PORT}/api-docs`);
}

// Gateway API routes (AFTER API routes!)
app.use('/', healthCheckMiddleware, gatewayRoutes);

// Error handling middleware
app.use((err, req, res, next) => {
  console.error('API Gateway Error:', err.stack);
  
  // –ï—Å–ª–∏ —ç—Ç–æ –æ—à–∏–±–∫–∞ –ø—Ä–æ–∫—Å–∏
  if (err.code === 'ECONNREFUSED' || err.code === 'ENOTFOUND') {
    return res.status(503).json({
      error: 'Service unavailable',
      message: 'One or more microservices are unavailable',
      timestamp: new Date().toISOString()
    });
  }
  
  res.status(500).json({ 
    error: 'Gateway error',
    message: process.env.NODE_ENV === 'development' ? err.message : 'Internal server error',
    timestamp: new Date().toISOString()
  });
});

// 404 handler
app.use((req, res) => {
  res.status(404).json({ 
    error: 'Not Found',
    message: `Route ${req.originalUrl} not found`,
    availableEndpoints: [
      '/health',
      '/api-docs',
      '/api/auth/*',
      '/api/movies/*',
      '/api/payment/*'
    ],
    timestamp: new Date().toISOString()
  });
});

// Graceful shutdown
process.on('SIGTERM', () => {
  console.log('SIGTERM received, shutting down gracefully');
  process.exit(0);
});

process.on('SIGINT', () => {
  console.log('SIGINT received, shutting down gracefully');
  process.exit(0);
});

// Start server
app.listen(PORT, () => {
  console.log(`üö™ API Gateway running on port ${PORT}`);
  console.log(`üìä Health check: http://localhost:${PORT}/health`);
  console.log(`üìö API Documentation: http://localhost:${PORT}/api-docs`);
  console.log(`üîó Auth Service: http://localhost:${PORT}/api/auth/*`);
  console.log(`üé¨ Movies Service: http://localhost:${PORT}/api/movies/*`);
  console.log(`üí≥ Payment Service: http://localhost:${PORT}/api/payment/*`);
  console.log(`‚è±Ô∏è  Uptime: ${process.uptime()}s`);
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤
  setTimeout(async () => {
    try {
      const healthResponse = await fetch(`http://localhost:${PORT}/health`);
      const healthData = await healthResponse.json();
      
      console.log('\nüìä Services Status:');
      healthData.services.forEach(service => {
        const status = service.status === 'healthy' ? '‚úÖ' : '‚ùå';
        console.log(`  ${status} ${service.name}: ${service.status}`);
      });
    } catch (error) {
      console.log('‚ö†Ô∏è  Could not check services health');
    }
  }, 2000);
});

export default app;
</file>

<file path="backend/auth-service/package.json">
{
  "name": "auth-service",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "start": "node src/index.js",
    "dev": "nodemon src/index.js",
    "build": "tsc",
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "type": "commonjs",
  "dependencies": {
    "bcryptjs": "^3.0.3",
    "cors": "^2.8.6",
    "dotenv": "^17.3.1",
    "express": "^5.2.1",
    "helmet": "^8.1.0",
    "jsonwebtoken": "^9.0.3",
    "morgan": "^1.10.1",
    "pg": "^8.18.0",
    "sqlite3": "^5.1.7"
  },
  "devDependencies": {
    "@types/bcryptjs": "^2.4.6",
    "@types/cors": "^2.8.19",
    "@types/express": "^5.0.6",
    "@types/jsonwebtoken": "^9.0.10",
    "@types/morgan": "^1.9.10",
    "@types/sqlite3": "^3.1.11",
    "nodemon": "^3.1.11",
    "ts-node": "^10.9.2",
    "typescript": "^5.9.3"
  }
}
</file>

<file path="frontend/package.json">
{
  "name": "frontend-vite",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "tsc -b && vite build",
    "lint": "eslint .",
    "preview": "vite preview"
  },
  "dependencies": {
    "react": "^19.2.0",
    "react-dom": "^19.2.0",
    "react-router-dom": "^7.13.0"
  },
  "devDependencies": {
    "@eslint/js": "^9.39.1",
    "@types/node": "^24.10.1",
    "@types/react": "^19.2.7",
    "@types/react-dom": "^19.2.3",
    "@vitejs/plugin-react": "^5.1.1",
    "autoprefixer": "^10.4.24",
    "eslint": "^9.39.1",
    "eslint-plugin-react-hooks": "^7.0.1",
    "eslint-plugin-react-refresh": "^0.4.24",
    "globals": "^16.5.0",
    "postcss": "^8.5.6",
    "tailwindcss": "^3.4.1",
    "typescript": "~5.9.3",
    "typescript-eslint": "^8.48.0",
    "vite": "^7.3.1"
  }
}
</file>

<file path="frontend/src/App.tsx">
import { BrowserRouter as Router, Routes, Route } from 'react-router-dom';
import Header from './components/Header';
import Footer from './components/Footer';
import HomePage from './pages/HomePage';
import MoviesPage from './pages/MoviesPage';
import './App.css';

function App() {
  return (
    <Router>
      <div className="min-h-screen flex flex-col">
        <Header />
        <main className="flex-grow">
          <Routes>
            <Route path="/" element={<HomePage />} />
            <Route path="/movies" element={<MoviesPage />} />
            <Route path="/movies/:id" element={<MoviesPage />} />
          </Routes>
        </main>
        <Footer />
      </div>
    </Router>
  );
}

export default App;
</file>

<file path="frontend/src/pages/HomePage.tsx">
import React from 'react';
import { Link } from 'react-router-dom';

const HomePage: React.FC = () => {
  return (
    <div className="min-h-screen bg-gray-50">
      {/* Hero —Å–µ–∫—Ü–∏—è */}
      <section className="bg-gradient-to-r from-blue-600 to-purple-600 text-white">
        <div className="container mx-auto px-4 py-20">
          <div className="text-center">
            <h1 className="text-5xl font-bold mb-6">
              –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ CineScope
            </h1>
            <p className="text-xl mb-8 max-w-2xl mx-auto">
              –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –æ–Ω–ª–∞–π–Ω-–∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä —Å —É–¥–æ–±–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –ø–æ–∫—É–ø–∫–∏ –±–∏–ª–µ—Ç–æ–≤. 
              –ù–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å –Ω–æ–≤—ã–º–∏ –ø—Ä–µ–º—å–µ—Ä–∞–º–∏ –≤ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–π –∞—Ç–º–æ—Å—Ñ–µ—Ä–µ.
            </p>
            <div className="space-x-4">
              <Link 
                to="/movies" 
                className="bg-red-600 hover:bg-red-700 text-white px-8 py-3 rounded-lg text-lg font-semibold transition-colors duration-200 inline-block"
              >
                –ö—É–ø–∏—Ç—å –±–∏–ª–µ—Ç
              </Link>
              <Link 
                to="/movies" 
                className="bg-white text-gray-900 hover:bg-gray-100 px-8 py-3 rounded-lg text-lg font-semibold transition-colors duration-200 inline-block"
              >
                –°–º–æ—Ç—Ä–µ—Ç—å –∞—Ñ–∏—à—É
              </Link>
            </div>
          </div>
        </div>
      </section>

      {/* –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ */}
      <section className="py-16">
        <div className="container mx-auto px-4">
          <h2 className="text-3xl font-bold text-center mb-12">–ü–æ—á–µ–º—É –≤—ã–±–∏—Ä–∞—é—Ç –Ω–∞—Å</h2>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div className="text-center">
              <div className="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <span className="text-2xl">üé¨</span>
              </div>
              <h3 className="text-xl font-semibold mb-2">–ù–æ–≤—ã–µ –ø—Ä–µ–º—å–µ—Ä—ã</h3>
              <p className="text-gray-600">
                –ü–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–∏–Ω–∫–∏ –∫–∏–Ω–æ–ø—Ä–æ–∫–∞—Ç–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
              </p>
            </div>
            <div className="text-center">
              <div className="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <span className="text-2xl">üé´</span>
              </div>
              <h3 className="text-xl font-semibold mb-2">–£–¥–æ–±–Ω—ã–µ –±–∏–ª–µ—Ç—ã</h3>
              <p className="text-gray-600">
                –û–Ω–ª–∞–π–Ω –ø–æ–∫—É–ø–∫–∞ –∏ –≤—ã–±–æ—Ä –º–µ—Å—Ç –≤ –∑–∞–ª–µ
              </p>
            </div>
            <div className="text-center">
              <div className="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <span className="text-2xl">üçø</span>
              </div>
              <h3 className="text-xl font-semibold mb-2">–ö–æ–º—Ñ–æ—Ä—Ç</h3>
              <p className="text-gray-600">
                –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–ª—ã –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∑–≤—É–∫
              </p>
            </div>
          </div>
        </div>
      </section>

      {/* –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ñ–∏–ª—å–º—ã */}
      <section className="py-16 bg-white">
        <div className="container mx-auto px-4">
          <h2 className="text-3xl font-bold text-center mb-12">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ñ–∏–ª—å–º—ã</h2>
          <div className="text-center mb-8">
            <Link 
              to="/movies" 
              className="bg-red-600 hover:bg-red-700 text-white px-8 py-3 rounded-lg text-lg font-semibold transition-colors duration-200 inline-block"
            >
              –°–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Ñ–∏–ª—å–º—ã üé¨
            </Link>
          </div>
          <p className="text-gray-600 text-center">
            –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –ø–æ–ª–Ω—ã–º –∫–∞—Ç–∞–ª–æ–≥–æ–º —Ñ–∏–ª—å–º–æ–≤
          </p>
        </div>
      </section>
    </div>
  );
};

export default HomePage;
</file>

</files>
